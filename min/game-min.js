function randomEntry(t){return t[Math.floor(Math.random()*t.length)]}function roll(t){for(var e=t.slice(0,t.indexOf("d")),r=t.slice(t.indexOf("d")+1),s=0,a=e-1;a>=0;a--)s+=Math.floor(Math.random()*r)+1;return s}function rollHits(t,e){for(var r=t.slice(0,t.indexOf("d")),s=t.slice(t.indexOf("d")+1),a=0,o=r-1;o>=0;o--){var n=roll("1d"+s);(n>=e||n===s)&&a++}return a}function Game(){this.log={element:document.getElementById("gameLog"),add:function(t){this.element.innerHTML+=t+"<br />",this.element.scrollTop=this.element.scrollHeight}},this.currentLocation=new Location,this.playerHero=new Hero("TEMP"),this.currentMonster=new Monster,this.previousMonsterName="",this.initialize=function(){this.currentLocation.draw(),this.playerHero.equip1(new Sword),this.playerHero.draw(),this.playerHero.updateHP(),this.switchMonster()},this.enterMonster=function(t){this.previousMonsterName=this.currentMonster.displayName;var e=t.slice(0,t.indexOf(" ")),r=t.slice(t.indexOf(" ")+1);-1===t.indexOf(" ")&&(e=t,r="");var s=new window[e](r);s.div.className="",s.hand1&&s.equip1(s.hand1),s.appear(),this.currentMonster=s},this.switchMonster=function(){var t=randomEntry(currentGame.currentLocation.monsterArray);currentGame.enterMonster(t)},this.attack=function(){interfaceElement.classList.add("wait");var t=0,e=["player turn","monster turn","end"],r=setInterval(function(){switch(e[t]){case"player turn":var s=currentGame.playerHero.useHand1();currentGame.currentMonster.calcDodge()?currentGame.currentMonster.dodge():currentGame.currentMonster.hit(s);break;case"monster turn":if(currentGame.currentMonster.HP>0){var a=currentGame.currentMonster.useHand1();currentGame.playerHero.calcDodge()?currentGame.playerHero.dodge():currentGame.playerHero.hit(a)}break;case"end":currentGame.playerHero.HP>0&&interfaceElement.classList.remove("wait"),clearInterval(r)}t++},1e3)}}function Displayable(){}function Location(t){switch(this.canvas=document.getElementById("level-sprite").getContext("2d"),this.shortName=t,t){case"Dungeon":this.spriteCompressed="BwBgHgLCA+CM8MU5LVvRzCQi3/qORxJ2JuuBV1Z5xNDjTzLjOsFlhKnXrzFDojod2ddvwFCu40fXKSpg+LPFEhittLIqkvBX00FBM9WpESdGo8hO195+rvXabw13Idq5K0hsNGdtJi3q6UYs7WbtoBUU7y4WbhUW5BngmO6aKR0ZGmBo6JITm5aYXmWRJpNmUWfnEu7rGaQXwy6UkVHrkeGRWFJT3Knh11Xe09ur4hmaQKMZPDffPWhm3dgRtT0zPL2QvRteVjEXbN/K3Hqgl5pWFXJ5y3h/fl7u9xW4rV9iM+c8UDqlep0vLsvM9gUtvJ1Kn4fjVVjCTA4dtgvpIjqjGjxuMNEfjcW0ClVkoSWiCSflQU8gQSGgD2stlKdzgIUfYkilbJZJsZ5Gwut9ZPzkZlWG8dgogA==",this.monsterArray=["Axedude","Ball Goo","Skele Bones","Skele Footman","Mage"];break;case"Volcano":this.spriteCompressed="BwBgHgLCA+CM8MUpJWpWz6308/sWBxJuRiIhWO6ZupF5peGTC1eLhD+Ht7fSgLZV6VfjlE9kg2XK5Txk7rSHTW8zW1XVGQ/uuFatRpQtOGZus8bJrlBvWssantxwedXHLuhs1iAhTM5r5eRnKBQezM0b7cBCYJesHEXuHx3pG8lM4ZUX6ZidmJij4FcUX+1qWeaWn5mSXeKLHFjS5MHQrlMSGhhgM5fCQdbiIMyqM9vcnSM+qzbhj1nRljlrPdYflLi43bO6NFU627J8fxuZfhGyGXm3uKMU8POYP2kzIVg22TdV8+j8eKdvl9JHcIalNkDhg9VPNxND5ulpuU8qD2n5XnZeKtPOlMVkOPtdgdscM9kQSf1Kb0JHMIh5BDYMSy7CMwT9jJyeXztMjWazqcyAvyWKiObj5P8ablOMSaRyFsKBhMmrJVWzleqqnT3Di9SdsJq7kbzfR5aggA==",this.monsterArray=["Axedude","Ball Fire","Skele Monk","Skele Bruiser","Were Hellbeast"];break;case"Forest":this.spriteCompressed="BwBgHgLCA+IgjIpiF3muDnNZ9ftDNiCUtsTyiMbClca06dLTn8T3HcuyGq6rToL7DqHASIYd2oobInFmWMcvwtJFIWxxyd9RUzXCjy7acGtZVs4fXXzm8nn0p0crvyaaNnJRXp+EXc7S1CFQy8AgwkiPkUzLwtEpVV3AX9LGzDsh1S0kMDXJNcZbh9fcqdKqXlbJIiEpt0i/WdKTzdclPti1p12gsDK5OppMji9C0HM8SmK4cjJKm708LnIxpU63W2C1HWtftHPVZWOyYuczYU9s5DVh5dT9KGsnejHu8K4g6vb8xqG6fVLGV6zU7aIH/Fp+T69N5aQE5RFRDKiDxbZHwmHvSaxZoLMqIp4nJHLbaksniL4HAkA5JGAhiIlVFrqb68CYbZlsVmHVpPYJHfEEvlYiEqMXVNyy4X+UilXz4oJymIyQorXbOUlY6yYhk/YLjYEOfXNSHo+Ea/oRBYzan2UW/J0sRpcgwQoq2S5urLugGugN9WH2hUYI1SSMM0bLbmBtW3RMJ9XsxYRgPux2Z4U5vPO/OFov5oA=",this.monsterArray=["Axedude","Scamp","Were Wolf","Skele Archer","Snek"];break;case"Graveyard":this.spriteCompressed="BwBgHgLCA+CM8MU5KQhRjbZt5+6+RR2xm6uFlhSpZOt1Ol9JzT12nZHqDrJLi054ONAkPEDpCPBOHcRVJjNWNGCsYqlq5ApSPYGWa5MNTHmGrUtN8K/WZpMWbcnadEHH5KsWUudkZeKr7qYbahWJHOJrzyTqLy7tp6wQEhsbIEiFGENDFukrHFmR65dFjplsZF3oGeGbVlNc10HlHZ6dVNvdX9hpU5uWZ9mT3FEwETw/mk+Qm1A6klY+y06w78g/WrpTNGDEPJw07BVjt1yyqd2fGJPderT17bZidSXI9tpTVHfv8Nvd1L9QYVdlYzjoMj5YWCxistkIKpDdADZrt4Q5kTjTtFUSj5okEW5ttjAeVVH45nUvilqTljvRboSkYijocKVtYUFmU9IeYCbz1jJtIt3kzhXZJBdJVKeJSIrj5SqFZtFarNeEtTrdXr9QbDUbjSbTWb9UA===",this.monsterArray=["Were","Skele"]}document.body.className=this.shortName,document.getElementById("level-text").innerHTML="LVL: "+this.shortName}function Character(){}function Hero(t){this.div=document.getElementById("hero"),this.canvas=document.getElementById("hero-sprite").getContext("2d"),this.heroName=t,this.displayElement={hpText:document.getElementById("hero-hp-text"),hpBar:document.getElementById("hero-hp-bar"),name:document.getElementById("hero-name")},this.displayElement.name.innerHTML=t,this.stats={str:8,agi:8,"int":8,cha:8,def:1,maxHP:100},this.HP=this.stats.maxHP,this.kills=0,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNfcY267a6EbHGlkkp6VVJ4EnmIOOs5maVc3vWt1kVQfSFpBI/FOkzZc+QsUJJqFUOYdOmrdTY7RbZXQbcKG8bwos+9ATZZjVfKkA===",this.color="white"}function Monster(){this.div=document.getElementById("monster"),this.canvas=document.getElementById("monster-sprite").getContext("2d"),this.shortName="",this.displayElement={hpText:document.getElementById("monster-hp-text"),hpBar:document.getElementById("monster-hp-bar"),name:document.getElementById("monster-name")}}function Axedude(t){this.stats={str:10,agi:5,"int":5,cha:2,def:2,maxHP:16},this.spriteCompressed="IwNgHgLAHAPgDAxTktW9GnG8ZvG475Y4FzFkUUJFHl62nWO0ovnap01ff1us0LajSacRHAvhGcpQqhP5ZeAzGvUbNW7Tsx8elUg1n0ZS86MYXhhY8IGsjdsg5MSr8j86YrLFyXJcbL4kumHqQA==",this.displayName="Axedude",this.color="#f8d878"}function Ball(t){this.stats={str:7,agi:7,"int":1,cha:1,def:0,maxHP:15},""===t&&(t=randomEntry(["Fire","Goo"]));var e="IwNgHgLAHAPgDAxTktW9HNbcXncF6qEkqFzAUHLWV1EKmPnN51UNvu1L0nuJKHahWJVR+RliHYZ2eQsVLlK1Wtb5+Ofg0E6Re2i1ZthMrVuZmeg66dvWpZcXJxOMrj+u8/fGIA==",r="IwNgHgLAHAPgDAxTktWxx0YZrTi7qYHFrElyH7kmnW22UaM1M4WmPsXcH1Ot6nHkIZkGVVCLwzZc+QsVLlKhZKy512Slvw66KGger6OyCS2YW+hCab69h0sWNF3z18a6IO4QA===";switch(t){case"Goo":this.spriteCompressed=e,this.displayName="floating ball of dripping ooze",this.shortName="Gooball",this.color="#d800cc";break;case"Fire":this.spriteCompressed=r,this.displayName="floating orb of fire",this.shortName="Fireball",this.color="#f83800"}}function Scamp(t){this.stats={str:2,agi:12,"int":10,cha:8,def:0,maxHP:10},this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNbcY2G7a6EbHFYmll47WVI1kHpNWu170qU2q/P5BQ4SNFjxEyVypFybOTMx0WdfokZy1ydhwV9C0hry3rtk8xcuIgA=",this.displayName="Scamp",this.color="#b8f818"}function Skele(t){switch(this.stats={str:6,agi:6,"int":6,cha:2,def:0,maxHP:12},""===t&&(t=randomEntry(["Footman","Archer","Monk","Bruiser","Flaming","Bones"])),this.color="#f0d0b0",t){case"Footman":this.stats.maxHP=14,this.stats.str=8,this.stats.def=1,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOGn3f7B5JGJHnFlV6mFwX2PWrklnGtX2ef5P99KLNukpC+CcSK5ZZc+QsVLlKjFIGSCbWiQ4VxHJjuYMcYjZON7257rV4jDKJ6JnC3ziZ5JA==",this.displayName="Skelebones Footman",this.hand1=new Sword;break;case"Archer":this.stats.agi=9,this.spriteCompressed="IwNgHgLAHAPgDAxTktW4aUY5xP/pLaFFzA57lXVWl5kIWPLVZ2YFlOn62oWdcgksw7t+4tpNwzZc+QsVKps4qtHd69TaO3caB8uLX6WfYzM5GJvayuETdInVqcq3knEA",this.displayName="Skelebones Archer";break;case"Monk":this.stats.agi=9,this.stats["int"]=9,this.stats.def=1,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOGn3f7B74JFnGLE55ErVzkN1PMkNWuMuGkb3e4O6ChVa9hbLFOkzZc+QsUTUogUlHVV3crTb9d6po1X9J49pU5lzhmn11bDNsWrOO1wIA=",this.displayName="Wise, Old Skelebones",this.shortName="Skelebones Monk",this.hand1=new Staff;break;case"Bruiser":this.stats.maxHP=16,this.stats.str=10,this.stats.def=2,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9biKxux+o5JHIl55kXb40pFY4Gnk0PnbulML28mO0KldvUw9c/DJPTSxxXAsVLlK1WvUdxE7vOaFmOnn0G6WRui1psOwk5252BTO5tEWtMzXI/7T77EA=",this.displayName="Skelebones who thinks he's a badass",this.shortName="Skelebones Bruiser",this.hand1=new Sword;break;case"Flaming":this.spriteCompressed="IwNgHgLAHAPgDAxdhNW4KVqRj3GbJb7Kl4mGn6F7Hq7nVWOqa5XrZ0LGPfPsOnIUxHCeJIfxwyKrSQsVLlK1WSUsuRaazYKaOiVkMGxBBofVEmDM2f69ew23eb6C7iXI/efWnEA=",this.displayName="Skelebones who is on fire",this.shortName="Flaming Skelebones",this.color="#ff5000";break;case"Bones":this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOFxPc7D7pGnGqEJFqGlzlINUrHXPZV30nsb5Mc8fRsKE8RuSVOkzZc+Qt5YBFeirxl13fitrVdqwWrESySwVu7mWJw9Ym2jVIA",this.displayName="Skelebones"}}function Snek(t){this.stats={str:9,agi:12,"int":5,cha:10,def:0,maxHP:10},this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNe14fib77pEEFpG7FXmF6ELWq2P0q2kuKdM5/8DBQ4SNFjx7Xs1IlKXJJTpsl2KQoXL2yNXA4zJPREA",this.displayName="Snek",this.color="#58d854"}function Were(t){this.stats={str:12,agi:7,"int":5,cha:3,def:1,maxHP:20},""===t&&(t=randomEntry(["Wolf","Goat","Hellbeast"]));var e="IwNgHgLAHAPgDAxTktW9Lhyxhx8HoHH6YkmrmFlU5JbnZ1N7Xb2LGv11fuecKaWsJyFSmQd0kDhyZh3m5lK1WvUbNmhisaiqNEYaHzaC9ownS+/PD1JWWTLszEHKbnZSmPFd37Z23koIQA==",r="IwNgHgLAHAPgDAxTktWpx0M8TWdaK7F6onkrlVlW422lFzV1F4lOfPHaOves+bHumqj2/Mm0JC0jZnMqFlK1WvUbRM7tvlyK+2pQaThY5Cb04KkwSIVcB1jBJGzzNXnozT8Pxf5KFpohqkA=";switch(t){case"Wolf":this.spriteCompressed=e,this.displayName="Werewolf",this.color="#ac7c00";break;case"Goat":this.stats.maxHP=22,this.stats.str=9,this.spriteCompressed=r,this.displayName="Weregoat",this.color="#d8d8d8";break;case"Hellbeast":this.stats.maxHP=25,this.stats.str=14,this.stats["int"]=8,this.stats.agi=8,this.spriteCompressed=r,this.displayName="loathsome, hellish beast",this.shortName="Hellbeast",this.color="#7c7c7c"}}function Mage(t){this.stats={str:5,agi:8,"int":12,cha:8,def:0,maxHP:12},this.spriteCompressed="IwNgHgLAHAPgDAxTktW97geV7dgEF75K4pG5ZmKGELU20Xn5Mk71GsMM0f3tBOKpTRV2vTtyGM2kprXIK6xVWvUbNWjJLHE2M/iXniBSxYe6LeI5fxWHdPAV0sUy843yXTHCs6R2PMqu2mHhCEA=",this.displayName="Wiz",this.color="#0058f8"}function Item(){this.owner=""}function Weapon(){this.target="Enemy"}function Sword(t){this.attackVal=function(){return 1+roll("2d3")}}function Staff(t){this.attackVal=function(){var t=this.owner.stats.str,e=this.owner.stats.agi;return 1+rollHits(t+e+"d5",5)}}function loadButtons(){for(var t=document.getElementsByClassName("button"),e=0;e<t.length;e+=1){var r=t[e].getAttribute("click-data");t[e].addEventListener("click",function(){currentGame[r]()})}}var __nativeST__=window.setTimeout;window.setTimeout=function(t,e){var r=this,s=Array.prototype.slice.call(arguments,2);return __nativeST__(t instanceof Function?function(){t.apply(r,s)}:t,e)};var currentGame=new Game,interfaceElement=document.getElementById("interface");Displayable.prototype.constructor=Displayable,Displayable.prototype.draw=function(){var t=LZString.decompressFromBase64(this.spriteCompressed),e=t.slice(t.indexOf("|")+1),r=t.slice(0,t.indexOf("x")),s=t.slice(t.indexOf("x")+1,t.indexOf("|"));this.canvas.clearRect(0,0,r,s),this.canvas.fillStyle=this.color;for(var a=0;a<e.length;a+=1)if(1==e.slice(a,a+1)){var o=Math.floor(a/r);this.canvas.fillRect(a-o*r,o,1,1)}},Location.prototype=new Displayable,Location.prototype.constructor=Location,Character.prototype=new Displayable,Character.prototype.constructor=Character,Character.prototype.updateHP=function(){this.HP<1&&(this.HP=0),this.displayElement.hpText.innerHTML=this.HP+"/"+this.stats.maxHP;var t=Math.floor(this.HP/this.stats.maxHP*100);this.displayElement.hpBar.style.width=t+"%",this.displayElement.hpBar.className="hp-bar hp-"+10*Math.round(t/10),0===this.HP&&this.die()},Character.prototype.addClass=function(t){this.div.classList.add(t)},Character.prototype.wiggle=function(t,e){this.div.classList.add(t);var r=this;setTimeout(function(){r.div.classList.remove(t)},e)},Character.prototype.equip1=function(t){t.owner=this,this.hand1=t},Character.prototype.getEnemy=function(){switch(this.constructor.name){case"Hero":return currentGame.currentMonster;case"Monster":return currentGame.playerHero}},Character.prototype.useHand1=function(){return this.hand1?this.hand1.attackVal():roll(Math.floor(this.stats.agi/4)+"d3")},Hero.prototype=new Character,Hero.prototype.constructor=Hero,Hero.prototype.hit=function(t){t-=this.stats.def,1>t&&(t=1),this.HP-=t,this.wiggle("hit",250),currentGame.log.add("The "+currentGame.currentMonster.shortName+" hit you for "+t+"HP."),this.updateHP()},Hero.prototype.calcDodge=function(){for(var t=[],e=currentGame.currentMonster.stats.agi-1;e>=0;e--)t.push(!1);for(var e=this.stats.agi/2-1;e>=0;e--)t.push(!0);return randomEntry(t)},Hero.prototype.dodge=function(){this.wiggle("dodge",500),currentGame.log.add("You dodge the "+currentGame.currentMonster.shortName+"'s attack.")},Hero.prototype.die=function(){this.addClass("dead"),currentGame.log.add("You were slain by the "+currentGame.currentMonster.shortName+"."),setTimeout(function(){currentGame.log.add("You slayed "+currentGame.playerHero.kills+" monsters before perishing.")},2e3)},Monster.prototype=new Character,Monster.prototype.constructor=Monster,Monster.prototype.announce=function(){var t="";t=currentGame.previousMonsterName===this.displayName?"another ":-1!=="AEIOU".indexOf(this.displayName.slice(0,1))?"an ":"a ";var e="It's "+t+this.displayName+"!";currentGame.log.add(e),""===this.shortName&&(this.shortName=this.displayName),this.displayElement.name.innerHTML=this.shortName},Monster.prototype.appear=function(){this.announce(),this.draw(),this.HP=this.stats.maxHP,this.updateHP()},Monster.prototype.die=function(){this.addClass("dead"),currentGame.log.add("You slayed the "+this.shortName+"."),currentGame.playerHero.kills++,setTimeout(currentGame.switchMonster,2e3)},Monster.prototype.hit=function(t){t-=this.stats.def,1>t&&(t=1),this.HP-=t,this.wiggle("hit",250),currentGame.log.add("You hit the "+this.shortName+" for "+t+"HP."),this.updateHP()},Monster.prototype.calcDodge=function(){for(var t=[],e=currentGame.playerHero.stats.agi-1;e>=0;e--)t.push(!1);for(var e=this.stats.agi/2-1;e>=0;e--)t.push(!0);return randomEntry(t)},Monster.prototype.dodge=function(){this.wiggle("dodge",500),currentGame.log.add("The "+this.shortName+" dodges your attack.")},Axedude.prototype=new Monster,Axedude.prototype.constructor=Axedude,Ball.prototype=new Monster,Ball.prototype.constructor=Ball,Scamp.prototype=new Monster,Scamp.prototype.constructor=Scamp,Skele.prototype=new Monster,Skele.prototype.constructor=Skele,Snek.prototype=new Monster,Snek.prototype.constructor=Snek,Were.prototype=new Monster,Were.prototype.constructor=Were,Mage.prototype=new Monster,Mage.prototype.constructor=Mage,Item.prototype=new Displayable,Item.prototype.constructor=Item,Weapon.prototype=new Item,Weapon.prototype.constructor=Weapon,Sword.prototype=new Weapon,Sword.prototype.constructor=Sword,Staff.prototype=new Weapon,Staff.prototype.constructor=Staff,loadButtons(),currentGame.playerHero=new Hero("Sandra"),currentGame.currentMonster=new Monster,currentGame.previousMonsterName="",currentGame.currentLocation=new Location(randomEntry(["Dungeon","Volcano","Forest","Graveyard"])),currentGame.initialize();