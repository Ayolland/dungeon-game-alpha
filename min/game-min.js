function randomEntry(e){return e[Math.floor(Math.random()*e.length)]}function roll(e){for(var t=e.slice(0,e.indexOf("d")),s=e.slice(e.indexOf("d")+1),r=0,n=t-1;n>=0;n--)r+=Math.floor(Math.random()*s)+1;return r}function Game(){this.log={element:document.getElementById("gameLog"),add:function(e){this.element.innerHTML+=e+"<br />",this.element.scrollTop=this.element.scrollHeight}},this.currentLevel=new Level,this.playerHero=new Hero("TEMP"),this.currentMonster=new Monster,this.previousMonsterName="",this.initialize=function(){this.currentLevel.draw(),this.playerHero.draw(),this.playerHero.updateHP(),this.switchMonster()},this.enterMonster=function(e){this.previousMonsterName=this.currentMonster.displayName;var t=new window[e];t.div.className="",t.appear(),this.currentMonster=t},this.switchMonster=function(){var e=randomEntry(["Axedude","Balltype","Scamp","Skele","Snek","Werebeing","Mage"]);currentGame.enterMonster(e)},this.attack=function(){document.getElementById("interface").className="wait";var e=Math.floor(4*Math.random())+1,t=Math.floor(4*Math.random())+1;this.currentMonster.HP>0&&this.playerHero.HP>0&&(roll("1d20")+this.currentMonster.stats.agi-this.playerHero.stats.agi>=20?this.currentMonster.dodge():this.currentMonster.hit(e)),this.currentMonster.HP>0&&this.playerHero.HP>0&&setTimeout(function(){roll("1d20")+currentGame.playerHero.stats.agi-currentGame.currentMonster.stats.agi>=20?currentGame.playerHero.dodge():currentGame.playerHero.hit(t)},1500),setTimeout(function(){document.getElementById("interface").className=""},2e3)}}function Displayable(){}function Level(){this.canvas=document.getElementById("level-sprite").getContext("2d"),this.spriteCompressed="BwBgHgLCA+CM8MU5LVvRzCQi3/qORxJ2JuuBV1Z5xNDjTzLjOsFlhKnXrzFDojod2ddvwFCu40fXKSpg+LPFEhittLIqkvBX00FBM9WpESdGo8hO195+rvXabw13Idq5K0hsNGdtJi3q6UYs7WbtoBUU7y4WbhUW5BngmO6aKR0ZGmBo6JITm5aYXmWRJpNmUWfnEu7rGaQXwy6UkVHrkeGRWFJT3Knh11Xe09ur4hmaQKMZPDffPWhm3dgRtT0zPL2QvRteVjEXbN/K3Hqgl5pWFXJ5y3h/fl7u9xW4rV9iM+c8UDqlep0vLsvM9gUtvJ1Kn4fjVVjCTA4dtgvpIjqjGjxuMNEfjcW0ClVkoSWiCSflQU8gQSGgD2stlKdzgIUfYkilbJZJsZ5Gwut9ZPzkZlWG8dgogA==",this.monsterArray=["Axedude","Balltype","Scamp","Skele","Snek","Werebeing","Mage"],this.shortName="dungeon",document.body.className=this.shortName}function Character(){}function Hero(e){this.div=document.getElementById("hero"),this.canvas=document.getElementById("hero-sprite").getContext("2d"),this.heroName=e,this.displayElement={hpText:document.getElementById("hero-hp-text"),hpBar:document.getElementById("hero-hp-bar"),name:document.getElementById("hero-name")},this.displayElement.name.innerHTML=e,this.maxHP=50,this.HP=this.maxHP,this.stats={str:8,agi:8,"int":8,cha:8},this.kills=0,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNfcY267a6EbHGlkkp6VVJ4EnmIOOs5maVc3vWt1kVQfSFpBI/FOkzZc+QsUJJqFUOYdOmrdTY7RbZXQbcKG8bwos+9ATZZjVfKkA===",this.color="white"}function Monster(){this.div=document.getElementById("monster"),this.canvas=document.getElementById("monster-sprite").getContext("2d"),this.shortName="",this.displayElement={hpText:document.getElementById("monster-hp-text"),hpBar:document.getElementById("monster-hp-bar"),name:document.getElementById("monster-name")}}function Axedude(e){this.maxHP=20,this.stats={str:10,agi:5,"int":5,cha:2},this.spriteCompressed="IwNgHgLAHAPgDAxTktW9GnG8ZvG475Y4FzFkUUJFHl62nWO0ovnap01ff1us0LajSacRHAvhGcpQqhP5ZeAzGvUbNW7Tsx8elUg1n0ZS86MYXhhY8IGsjdsg5MSr8j86YrLFyXJcbL4kumHqQA==",this.displayName="Axedude",this.color="yellow"}function Balltype(e){this.maxHP=15,this.stats={str:7,agi:7,"int":1,cha:1},this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNbcXncF6qEkqFzAUHLWV1EKmPnN51UNvu1L0nuJKHahWJVR+RliHYZ2eQsVLlK1Wtb5+Ofg0E6Re2i1ZthMrVuZmeg66dvWpZcXJxOMrj+u8/fGIA==",this.displayName="Gooball",this.color="purple"}function Scamp(e){this.maxHP=10,this.stats={str:2,agi:12,"int":10,cha:8},this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNbcY2G7a6EbHFYmll47WVI1kHpNWu170qU2q/P5BQ4SNFjxEyVypFybOTMx0WdfokZy1ydhwV9C0hry3rtk8xcuIgA=",this.displayName="Scamp",this.color="darkgreen"}function Skele(e){switch(this.maxHP=12,this.stats={str:6,agi:6,"int":6,cha:2},""===e&&(e=randomEntry(["Footman","Archer","Monk","Bruiser","Flaming"])),this.color="white",e){case"Footman":this.maxHP=14,this.stats.str=8,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOGn3f7B5JGJHnFlV6mFwX2PWrklnGtX2ef5P99KLNukpC+CcSK5ZZc+QsVLlKjFIGSCbWiQ4VxHJjuYMcYjZON7257rV4jDKJ6JnC3ziZ5JA==",this.displayName="Skelebones Footman";break;case"Archer":this.stats.agi=9,this.spriteCompressed="IwNgHgLAHAPgDAxTktW4aUY5xP/pLaFFzA57lXVWl5kIWPLVZ2YFlOn62oWdcgksw7t+4tpNwzZc+QsVKps4qtHd69TaO3caB8uLX6WfYzM5GJvayuETdInVqcq3knEA",this.displayName="Skelebones Archer";break;case"Monk":this.stats["int"]=9,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOGn3f7B74JFnGLE55ErVzkN1PMkNWuMuGkb3e4O6ChVa9hbLFOkzZc+QsUTUogUlHVV3crTb9d6po1X9J49pU5lzhmn11bDNsWrOO1wIA=",this.displayName="Wise, Old Skelebones",this.shortName="Skelebones Mage";break;case"Bruiser":this.maxHP=16,this.stats.str=10,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9biKxux+o5JHIl55kXb40pFY4Gnk0PnbulML28mO0KldvUw9c/DJPTSxxXAsVLlK1WvUdxE7vOaFmOnn0G6WRui1psOwk5252BTO5tEWtMzXI/7T77EA=",this.displayName="Skelebones who thinks he's a badass",this.shortName="Skelebones Bruiser";break;case"Flaming":this.spriteCompressed="IwNgHgLAHAPgDAxdhNW4KVqRj3GbJb7Kl4mGn6F7Hq7nVWOqa5XrZ0LGPfPsOnIUxHCeJIfxwyKrSQsVLlK1WSUsuRaazYKaOiVkMGxBBofVEmDM2f69ew23eb6C7iXI/efWnEA=",this.displayName="Skelebones who is on fire",this.shortName="Flaming Skelebones",this.color="#ff5000";break;default:this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOFxPc7D7pGnGqEJFqGlzlINUrHXPZV30nsb5Mc8fRsKE8RuSVOkzZc+Qt5YBFeirxl13fitrVdqwWrESySwVu7mWJw9Ym2jVIA",this.displayName="Skelebones"}}function Snek(e){this.maxHP=10,this.stats={str:9,agi:12,"int":5,cha:10},this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNOD4HcHp6K6oGnHKULVXmaW0r0M1Zw4drWnPOdVs5ARzzCWo8b3YzZc+QsVKFhIsKJCmkwltpaaE7iQar8bLJyZWR2flc0TLUkc+nL3H9kA",this.displayName="Snek",this.color="green"}function Werebeing(e){this.maxHP=20,this.stats={str:12,agi:7,"int":5,cha:3},this.spriteCompressed="IwNgHgLAHAPgDAxTktWpx0M8TWdaK7F6onkrlVlW422lFzV1F4lOfPHaOves+bHumqj2/Mm0JC0jZnMqFlK1WvUbRM7tvlyK+2pQaThY5Cb04KkwSIVcB1jBJGzzNXnozT8Pxf5KFpohqkA=",this.displayName="Werebeing",this.color="lightgray"}function Mage(e){this.maxHP=12,this.stats={str:5,agi:8,"int":12,cha:8},this.spriteCompressed="IwNgHgLAHAPgDAxTktW97geV7dgEF75K4pG5ZmKGELU20Xn5Mk71GsMM0f3tBOKpTRV2vTtyGM2kprXIK6xVWvUbNWjJLHE2M/iXniBSxYe6LeI5fxWHdPAV0sUy843yXTHCs6R2PMqu2mHhCEA=",this.displayName="Wiz",this.color="blue"}function loadButtons(){for(var e=document.getElementsByClassName("button"),t=0;t<e.length;t+=1){var s=e[t].getAttribute("click-data");e[t].addEventListener("click",function(){currentGame[s]()})}}var __nativeST__=window.setTimeout;window.setTimeout=function(e,t){var s=this,r=Array.prototype.slice.call(arguments,2);return __nativeST__(e instanceof Function?function(){e.apply(s,r)}:e,t)};var currentGame=new Game;Displayable.prototype.constructor=Displayable,Displayable.prototype.draw=function(){var e=LZString.decompressFromBase64(this.spriteCompressed),t=e.slice(e.indexOf("|")+1),s=e.slice(0,e.indexOf("x")),r=e.slice(e.indexOf("x")+1,e.indexOf("|"));this.canvas.clearRect(0,0,s,r),this.canvas.fillStyle=this.color;for(var n=0;n<t.length;n+=1)if(1==t.slice(n,n+1)){var o=Math.floor(n/s);this.canvas.fillRect(n-o*s,o,1,1)}},Level.prototype=new Displayable,Level.prototype.constructor=Level,Character.prototype=new Displayable,Character.prototype.constructor=Character,Character.prototype.updateHP=function(){this.HP<1&&(this.HP=0),this.displayElement.hpText.innerHTML=this.HP+"/"+this.maxHP;var e=Math.floor(this.HP/this.maxHP*100);this.displayElement.hpBar.style.width=e+"%",this.displayElement.hpBar.className="hp-bar hp-"+10*Math.round(e/10),0===this.HP&&this.die()},Character.prototype.addClass=function(e){this.div.classList.add(e)},Character.prototype.wiggle=function(e,t){this.div.classList.add(e);var s=this;setTimeout(function(){s.div.classList.remove(e)},t)},Hero.prototype=new Character,Hero.prototype.constructor=Hero,Hero.prototype.hit=function(e){this.HP-=e,this.wiggle("hit",250),currentGame.log.add("The "+currentGame.currentMonster.shortName+" hit you for "+e+"HP."),this.updateHP()},Hero.prototype.dodge=function(){this.wiggle("dodge",500),currentGame.log.add("You dodge the "+currentGame.currentMonster.shortName+"'s attack.")},Hero.prototype.die=function(){this.addClass("dead"),currentGame.log.add("You were slain by the "+currentGame.currentMonster.shortName+"."),setTimeout(function(){currentGame.log.add("You slayed "+currentGame.playerHero.kills+" monsters before perishing.")},2e3)},Monster.prototype=new Character,Monster.prototype.constructor=Monster,Monster.prototype.announce=function(){var e="";e=currentGame.previousMonsterName===this.displayName?"another ":-1!=="AEIOU".indexOf(this.displayName.slice(0,1))?"an ":"a ";var t="It's "+e+this.displayName+"!";currentGame.log.add(t),""===this.shortName&&(this.shortName=this.displayName),this.displayElement.name.innerHTML=this.shortName},Monster.prototype.appear=function(){this.announce(),this.draw(),this.HP=this.maxHP,this.updateHP()},Monster.prototype.die=function(){this.addClass("dead"),currentGame.log.add("You slayed the "+this.shortName+"."),currentGame.playerHero.kills++,setTimeout(currentGame.switchMonster,2e3)},Monster.prototype.hit=function(e){this.HP-=e,this.wiggle("hit",250),currentGame.log.add("You hit the "+this.shortName+" for "+e+"HP."),this.updateHP()},Monster.prototype.dodge=function(){this.wiggle("dodge",500),currentGame.log.add("The "+this.shortName+" dodges your attack.")},Axedude.prototype=new Monster,Axedude.prototype.constructor=Axedude,Balltype.prototype=new Monster,Balltype.prototype.constructor=Balltype,Scamp.prototype=new Monster,Scamp.prototype.constructor=Scamp,Skele.prototype=new Monster,Skele.prototype.constructor=Skele,Snek.prototype=new Monster,Snek.prototype.constructor=Snek,Werebeing.prototype=new Monster,Werebeing.prototype.constructor=Werebeing,Mage.prototype=new Monster,loadButtons(),currentGame.playerHero=new Hero("Sandra"),currentGame.currentMonster=new Monster,currentGame.previousMonsterName="",currentGame.currentLevel=new Level,currentGame.initialize();