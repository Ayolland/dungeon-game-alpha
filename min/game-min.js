function randomEntry(t){return t[Math.floor(Math.random()*t.length)]}function roll(t){for(var e=t.slice(0,t.indexOf("d")),s=t.slice(t.indexOf("d")+1),r=0,a=e-1;a>=0;a--)r+=Math.floor(Math.random()*s)+1;return r}function rollHits(t,e){for(var s=t.slice(0,t.indexOf("d")),r=t.slice(t.indexOf("d")+1),a=0,i=s-1;i>=0;i--){var n=roll("1d"+r);(n>=e||n===r)&&a++}return a}function thirdPerson(t){switch(t){case"bash":case"punch":case"slash":case"splash":t+="es";break;case"are":t="is";break;default:t+="s"}return t}function firstCap(t){return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}function shorten(t,e){return t.length>e&&(t=t.substring(0,e-4)+"..."),t}function firstWord(t){return t.slice(0,t.indexOf(" "))}function secondWord(t){return t.slice(t.indexOf(" ")+1)}function halfBlack(t){var e=0,s=0,r=0,a=1;if("#"===t.charAt(0))e=parseInt(t.substring(1,3),16),s=parseInt(t.substring(3,5),16),r=parseInt(t.substring(5,7),16);else{if("r"!==t.charAt(0))return"rgba(127,127,127,1)";var i=t.slice(5,-1).split(",");e=i[0],s=i[1],r=i[2],a=i[3]}return e=(e/2).toFixed(),s=(s/2).toFixed(),r=(r/2).toFixed(),a=((a+1)/2).toFixed(1),"rgba("+e+","+s+","+r+","+a+")"}function Game(){this["interface"]={element:document.getElementById("interface"),pause:function(){this.element.classList.add("wait")},unpause:function(){this.element.classList.remove("wait")}},this.log={element:document.getElementById("gameLog"),add:function(t){this.element.innerHTML+="<p>"+t+"</p>",this.element.scrollTop=this.element.scrollHeight}},this.dialog={element:document.getElementById("dialog"),message:document.getElementById("dialog-text"),buttons:document.getElementById("dialog-buttons"),open:function(){currentGame["interface"].pause(),loadButtons(this.element),this.element.classList.add("active")},setText:function(t){this.message.innerHTML=t},addButton:function(t,e){var s="<a class='button dialog' click-data='"+e+"'>"+t+"</a>";this.buttons.innerHTML+=s},close:function(){this.element.classList.remove("active");var t=this;setTimeout(function(){t.message.innerHTML="",t.buttons.innerHTML="",currentGame["interface"].unpause()},500)}},this.router=function(t){switch(this.dialog.close(),t){case"takeFoundItem":this.playerHero.addToInv(this.foundItem);break;case"closeDialog":default:currentGame.playerHero.offHand=""}},this.currentLocation=new Location,this.playerHero=new Hero("TEMP"),this.currentMonster=new Monster,this.previousMonsterName="",this.initialize=function(){currentGame.playerHero=new Hero("Sandra"),currentGame.currentMonster=new Monster,currentGame.previousMonsterName="",this.switchLocation(),this.playerHero.initialize()},this.enterMonster=function(t){this.previousMonsterName=this.currentMonster.displayName;var e=t.slice(0,t.indexOf(" ")),s=t.slice(t.indexOf(" ")+1);-1===t.indexOf(" ")&&(e=t,s="");var r=new window[e](s);r.div.className="",r.buffs=[],r.appear(),currentGame.currentMonster=r},this.switchMonster=function(){var t=randomEntry(currentGame.currentLocation.monsterArray);currentGame.enterMonster(t)},this.switchLocation=function(t){var e="undefined"==typeof currentGame.currentLocation?"":currentGame.currentLocation.shortName,s=["Dungeon","Volcano","Forest","Graveyard","Mine"];s.splice(s.indexOf(e),1),t=randomEntry(s),currentGame.currentLocation=new Location(t),currentGame.currentLocation.switchTrigger=currentGame.playerHero.kills+6+roll("1d4"),currentGame.currentLocation.draw(currentGame.currentLocation.canvas,currentGame.currentLocation.spriteCompressed),currentGame.currentLocation.canvas.fillRect(0,40,160,50),currentGame.log.add("You enter the "+t+"..."),setTimeout(function(){currentGame.switchMonster()},2e3)},this.everyoneIsAlive=function(){return this.playerHero.stats.HP>0&&this.currentMonster.stats.HP>0},this.runRound=function(t){this.foundItem="",this.dialog.close(),intervalRelay="Player turn";var e=setInterval(function(){if("Player turn"===intervalRelay)intervalRelay="wait",currentGame["interface"].pause(),currentGame.everyoneIsAlive()?currentGame.playerHero.runTurn(t):intervalRelay="End round";else if("Monster turn"===intervalRelay){intervalRelay="wait";var s=currentGame.currentMonster.ai();currentGame.everyoneIsAlive()?currentGame.currentMonster.runTurn(s):intervalRelay="End round"}else"End round"===intervalRelay&&(clearInterval(e),intervalRelay="wait",currentGame["interface"].unpause())},500)},this.inventoryRouter=function(t){var e=this.playerHero.inventory[t-1];"undefined"!=typeof e&&e.invDialog()},this.dropItem=function(t){this.dialog.close(),this.playerHero.inventory.splice(t,1),this.playerHero.updateStatus(),this.foundItem.sprite&&this.playerHero.addToInv(this.foundItem)},this.replace}function Displayable(){}function Location(t){switch(this.canvas=document.getElementById("level-sprite").getContext("2d"),this.shortName=t,t){case"Dungeon":this.spriteCompressed="BwBgHgLCA+CM8MU5LVvRzCQi3/qORxJ2JuuBV1Z5xNDjTzLjOsFlhKnXrzFDojod2ddvwFCu40fXKSpg+LPFEhittLIqkvBX00FBM9WpESdGo8hO195+rvXabw13Idq5K0hsNGdtJi3q6UYs7WbtoBUU7y4WbhUW5BngmO6aKR0ZGmBo6JITm5aYXmWRJpNmUWfnEu7rGaQXwy6UkVHrkeGRWFJT3Knh11Xe09ur4hmaQKMZPDffPWhm3dgRtT0zPL2QvRteVjEXbN/K3Hqgl5pWFXJ5y3h/fl7u9xW4rV9iM+c8UDqlep0vLsvM9gUtvJ1Kn4fjVVjCTA4dtgvpIjqjGjxuMNEfjcW0ClVkoSWiCSflQU8gQSGgD2stlKdzgIUfYkilbJZJsZ5Gwut9ZPzkZlWG8dgogA==",this.monsterArray=["Axedude","Ball Goo","Skele Bones","Skele Footman","Mage","Jelly"];break;case"Volcano":this.spriteCompressed="BwBgHgLCA+CM8MUpJWpWz6308/sWBxJuRiIhWO6ZupF5peGTC1eLhD+Ht7fSgLZV6VfjlE9kg2XK5Txk7rSHTW8zW1XVGQ/uuFatRpQtOGZus8bJrlBvWssantxwedXHLuhs1iAhTM5r5eRnKBQezM0b7cBCYJesHEXuHx3pG8lM4ZUX6ZidmJij4FcUX+1qWeaWn5mSXeKLHFjS5MHQrlMSGhhgM5fCQdbiIMyqM9vcnSM+qzbhj1nRljlrPdYflLi43bO6NFU627J8fxuZfhGyGXm3uKMU8POYP2kzIVg22TdV8+j8eKdvl9JHcIalNkDhg9VPNxND5ulpuU8qD2n5XnZeKtPOlMVkOPtdgdscM9kQSf1Kb0JHMIh5BDYMSy7CMwT9jJyeXztMjWazqcyAvyWKiObj5P8ablOMSaRyFsKBhMmrJVWzleqqnT3Di9SdsJq7kbzfR5aggA==",this.monsterArray=["Axedude","Ball Fire","Skele Monk","Skele Bruiser","Were Hellbeast"];break;case"Forest":this.spriteCompressed="IwNgDAHgLGA+ZmE5TEOOhiUrVj+ORWJhq2OpFlBtZxBm9R5V6y7lpLrjtPeJpx6M2IjlRH5p1GiVHjWYxcpZC8U3vPFtuapc1yCNArYa67huA+bq3rgvjstXiqrgpUY+9m5Of+DKKyDMK+we7WEa6oBl5hMUYuptEhsZFy2okSyQF6oYH6etl++QIZSdpqxkwqLmkUMiUV5BH8UvX6Zmnejfbq7D053FUcEp6hceVt3nnyo7GtC4sDPauKw01W1NjLs7tlRjMbYoc7SkGW5TUlmwNyFiEHNdfRG29ns8MdLXaH11tXLJ/nd+jchpV1jRIUVdK97nV5iCdntwYkZMETiNkTCCr9MMc5lMojZYfi0ISfoNliiaaCOulCgC/g07kE3tNekzqrUnNCOWM/Az6Yj2oY+kyJXtWiKAnygaDgbK3Iqsd0npDtsqPKU1al2QKxjdhYbNJjxftuRTueMhSdShrnnTjZzTYirZrHZSjnb3qkNdqViClm7LlcHqGndkCb9BbkHL6ovMflzpW5w2GcQohtJvQCWlGYk6vpMXViM9CKsWc708zy4V0q3E1rWbemK0mbVGSwmy3MC6TG8mk/w248Gyq292lVzB+6Jx4xy8Z1k0+Ou4y08vK4Rg+2m6nwhNBZ58hCfHvLUe6RdMYsU2Or+fbz6CXf3qsGhTj1SVXRiWqVbfmu3w6k4Z51ISfRPh+4oSsS55Qveb5rtBf7gfQiF1sOvhoWBu6YfEwY4ay6EkqeYSwQsuwUV0YHkau5zlswNGrnRjRmhR8HuuyxgniSHEpFxOTMbxEwBuB/HnJwwG3DKKR7txgn3rO6S8HqCkgVoXipoG1Q6ABD46Y4iYmkO17UZc6mbPanGPu+KkrNZhl0exl7tPyRQebafoGoezhCV5RbPgZDi2OFpEoq8vkMtG6KRT66YxbFIVJX5BxEj4PZBclfLkZamW5s+1rJVmnawfxxm5WVcYhTJvk0Q1M6eTKb65QFpXNflo7fu1Zl9aFA0DalfUjUNrnjZNU3TTNs0sEAA=",this.monsterArray=["Axedude","Scamp","Were Wolf","Skele Archer","Snek"];break;case"Graveyard":this.spriteCompressed="IwNgDAHgLGA+wMU5LVjKzn3HXrCGBxJuRp2GeOB5F9ZDKV+1Ny7TFdXZbO+Zp2I9+fYb1zjWYsSVFtpkjtIGzF86lObblSGQfUy0/HoQnKWppaYkG9XQatVWt+tWYcj2RrbZdevMK+hqEWgd4citb+4Qxu8bYhSQmWTvQxKX7WEXJRSYzuyXmBGvku6eZZHhGESkUeqfnZ0Z6W9YitZUJdbm1BjbKahbTOub3impUmOV6Z3SZRtK5xTPNNQktYg6He6yuC0Z0+flVhVss2sQmzTjnZAd3Fjzd1x+lE5PuDDTsHK503mc6J93r1zi9wT9lv06t9/pCWkjYXwRBVrtV/hiUdwEZi/tj/HN8fDCSlAT0LJ8oVjSaSgb80MDyfDERC7Colqzuc9Mjp9Jt5pMWedDOi3tTQdp2QVkRMRQIJXClc4yXjeUNKhcqBKNTS2X8pFrUTrpcVdrK5YdWCMGgzGPrLaKATtbUaNszrY69X0Pe6bUUDervRoFoCjoG1UHo4rdBTTu5/VaYxrpfyE8ck1a1bF3YUWCoI4Lac7zTqaKDgv644mCeiy8ZOLGBUX7QSc+sHSD7Vma03JSHkWbbWo9KPwz6LeYRwW0iPPWKWV3l1LtrOuavF07XCvTc3KNN8yNk/th+WHbUCwPDafqUa8ziMheg4qvc/12s/dPXyETdaV6ijiHrWV6/uWhwAT2tQwkO4EVpBNbQdsiL5gGqwDI+OidhWaGYRk6EHsYJpYXhSGXI2AYtqRZGUH+gE0biQF0cBDGLJ+gGmqxXE1PeXHcdq1HtNwiR0XxUHYAMYlSVs0myXJ/JrPJjhBEpqlqepGmaVp2k6bpen6QZgRAA===",this.monsterArray=["Were","Skele"];break;case"Mine":this.spriteCompressed="IwNgDAHgLGA+wMU5LVvRzXs93/BhRxJpZ5FlV1Ntd9DjTzLrb7HnX3PvfwYJIITCyo0QP4lx7MIPlUFc2YgljJ9GSgWUdyLXT3k1Q46bTLVeCZdQ2zF3RhOlLc2wJf4P74R4eOrl5CwdbKvr6q/rjuURHy0YSJ+qFJsYbx6YqZycZZtDkp3rY5kbqlJbkWaoVBKbFlGmmeES1ZVdrirZmexF3hjSKpdiED7X0JFW7DnUNTCX1xY/ZJSw3pM9U9kw1EO+FtrXtz+yWLhz0ix/PxezeRm9prl49PJ7VNYRcVn9bfpb0CP0AVdVu9LqC/v9Cq9TPc3EDRiDfjgajtARQHuszt4lm18eV8f5Yb98vlzkd3lZcVS1pDpD5iXkQjRBoMUc56jZycyok59PShmlgSc+c1RQSWuLzCYSccGXE5mK7oqpULpFJqDVBXKBTK9ZrDUbjSbTWbzRbLVbrTbbXb7Q7HU7nS7XW73R7PV7vT7fX7/QggA=",this.monsterArray=["Skele Footman","Were Goat","Jelly","Snek"]}document.body.className=this.shortName,document.getElementById("level-text").innerHTML="LVL: "+this.shortName}function Character(){this.buffs=[],this.resists={},this.inventory=[]}function Hero(t){this.div=document.getElementById("hero"),this.canvas=document.getElementById("hero-sprite").getContext("2d"),this.heroName=t,this.displayElement={hpText:document.getElementById("hero-hp-text"),hpBar:document.getElementById("hero-hp-bar"),name:document.getElementById("hero-name")},this.displayElement.name.innerHTML=t,this.stats={str:8,agi:8,"int":8,cha:8,phys:1,magi:0,maxHP:50},this.stats.HP=this.stats.maxHP,this.kills=0,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNfcY267a6EbHGlkkp6VVJ4EnmIOOs5maVc3vWt1kVQfSFpBI/FOkzZc+QsUJJqFUOYdOmrdTY7RbZXQbcKG8bwos+9ATZZjVfKkA===",this.color="white",this.buffs=[]}function Monster(){this.div=document.getElementById("monster"),this.canvas=document.getElementById("monster-sprite").getContext("2d"),this.shortName="",this.displayElement={hpText:document.getElementById("monster-hp-text"),hpBar:document.getElementById("monster-hp-bar"),name:document.getElementById("monster-name")},this.buffs=[],this.inventory=[]}function Axedude(t){this.stats={str:10,agi:5,"int":5,cha:2,phys:2,magi:0,maxHP:16},this.spriteCompressed="IwNgHgLAHAPgDAxTktW1xPGdx2u5IF5yF4BMZZCBx1tdODxTtpmGWJKbNnL/Xq3wdqNQh1I8qY8UVlScnaelVr1GzVu07VAviX3jJUscEpFpDRXmb5hzK3RPyTsoe6FOjxkfZXGNrbyaGbKTEA==",this.displayName="Axedude",this.color="#f8d878",this.item1=new Sword("Iron"),this.item2=new Vial("Steroids"),this.aiType="buffer"}function Ball(t){this.stats={str:7,agi:7,"int":1,cha:1,phys:0,magi:1,maxHP:15},""===t&&(t=randomEntry(["Fire","Goo"]));var e="IwNgHgLAHAPgDAxTktW9HNe54fd6HBpGkpEBMwVhyhVDtipFrZCl1XTc+ejfJMVK1izDuzF1ewrGKnoFuHCtVr1GzVvU8SIvSKUzD+IZyJn63HiJoWJxsguGHeQifaNvByt7+zAQA===",s="IwNgHgLAHAPgDAxTktWxx0YZrTi7qYHFrElyH7kmnW22Ua0BMwbBTOJbvj3PFhwrN2Y4clZiR9BlVkyynPCtVr1GzVu06t8rLn3ZKR/CbooaF6uYry5jQg8eiec1+IYLhyj+8nOSl4GvkA==";switch(t){case"Goo":this.spriteCompressed=e,this.displayName="floating ball of dripping ooze",this.shortName="Gooball",this.color="#d800cc";break;case"Fire":this.resists={fire:-.5},this.spriteCompressed=s,this.displayName="floating orb of fire",this.shortName="Fireball",this.color="#f83800",this.item1=new Hose("Fire")}}function Scamp(t){this.stats={str:2,agi:12,"int":10,cha:8,phys:0,magi:1,maxHP:10},this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNbcY2G7a6EbHFYmll47WVI1kHpNWu170qU2q/P5BQ4SNFjxEyVypFybOTMx0WdfokZy1ydhwV9C0hry3rtk8xcuIgA=",this.displayName="Scamp",this.color="#b8f818",this.item1=new Potion("Regen"),this.aiType="random"}function Skele(t){switch(this.stats={str:6,agi:6,"int":6,cha:2,phys:0,magi:0,maxHP:12},this.resists={fire:1.5},""===t&&(t=randomEntry(["Footman","Archer","Monk","Bruiser","Flaming","Bones"])),this.color="#f0d0b0",t){case"Footman":this.stats.maxHP=14,this.stats.str=8,this.stats.phys=1,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOGn3f7B5JGJHnFlV6mFwX2PWrklnGtX2ef5P99KLNukpC+CcSK5ZZc+QsVLlKjFIGSCbWiQ4VxHJjuYMcYjZON7257rV4jDKJ6JnC3ziZ5JA==",this.displayName="Skelebones Footman",this.item1=new Sword;break;case"Archer":this.stats.agi=10,this.spriteCompressed="IwNgHgLAHAPgDAxTktW4aUY5xP/pLaFFzA57lXVWl5kIWPLVZ2YFlOn62oWdcgksw7t+4tpNwzZc+QsVKps4qtHd69TaO3caB8uLX6WfYzM5GJvayuETdInVqcq3knEA",this.displayName="Skelebones Archer";break;case"Monk":this.stats.agi=16,this.stats["int"]=9,this.stats.phys=1,this.stats.magi=1,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOGn3f7B74JFnGLE55ErVzkN1PMkNWuMuGkb3e4O6ChVa9hbLFOkzZc+QsUTUogUlHVV3crTb9d6po1X9J49pU5lzhmn11bDNsWrOO1wIA=",this.displayName="Wise, Old Skelebones",this.shortName="Skelebones Monk",this.item1=new Staff;break;case"Bruiser":this.stats.maxHP=18,this.stats.str=10,this.stats.phys=2,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9biKxux+o5JHIl55kXb40pFY4Gnk0PnbulML28mO0KldvUw9c/DJPTSxxXAsVLlK1WvUdxE7vOaFmOnn0G6WRui1psOwk5252BTO5tEWtMzXI/7T77EA=",this.displayName="Skelebones who thinks he's a badass",this.shortName="Skelebones Bruiser",this.item1=new Sword("Iron");break;case"Flaming":this.stats.maxHP=20,this.spriteCompressed="IwNgHgLAHAPgDAxdhNW4KVqRj3GYBMe+CwxxW+55xpNld1uGh9yZVqmuH2XBdASoC+LMuz6kx0qXKGDJEpctlr1GzVvaj+unMhLTWR6hVPoKTfuZr0W+iVguDx+3aJEiF4+Qb/cikqOciECjuFAA",this.displayName="Skelebones who is on fire",this.shortName="Flaming Skelebones",this.addBuff("Aflame"),this.color="#ff5000";break;case"Bones":this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOFxPc7D7pGnGqEJFqGlzlINUrHXPZV30nsb5Mc8fRsKE8RuSVOkzZc+Qt5YBFeirxl13fitrVdqwWrESySwVu7mWJw9Ym2jVIA",this.displayName="Skelebones"}}function Snek(t){var e="IwNgHgLAHAPgDAxTktW9HNe14fib77pEEFpG7FXmF6ELWq2P0q2kuKdM5/8DBQ4SNFjx7Xs1IlKXJJTpsl2KQoXL2yNXA4zJPREA",s="IwNgHgLAHAPgDAxTktW9HNOD4HcHrABMpxuqBFeKJZ5RVmdD+hzpNzJXyvFtWjkGIqAuMLFMEU6VnkLFS5StVqhwxnNr1x2MRMr1WlbUc7c9aOr0YnRGyo776DMvLPGeBQA=";switch(this.stats={str:5,agi:9,"int":5,cha:9,phys:0,magi:0,maxHP:10},this.color="#58d854",""===t&&(t=randomEntry(["Big","Small"])),t){case"Big":this.hand1=new Claws,this.spriteCompressed=s,this.displayName="distressingly large Snek",this.shortName="Really Big Snek",this.stats.str=9,this.stats.agi=12,this.stats.cha=12,this.stats.maxHP=18;break;case"Small":default:this.item1=new Claws("Venom"),this.spriteCompressed=e,this.displayName="Snek"}}function Jelly(t){this.stats={str:7,agi:10,"int":0,cha:0,phys:4,magi:0,maxHP:20},this.resists={fire:1.25},this.item1=new Hose("Acid"),this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNwEy7/5bYYk07JI0q8xfPYOhS6spqk5mnd6tn17vw58hXZqL7jegnpRpEp03A365a5OgSzaduvfoOGjFTXkJCGFC1xyaGWxSuGPi4jRY4v2yj66+tOa39ObmCmBVUxDVMaIA===",this.displayName="quivering, gelatinous cube",this.shortName="Box Jelly",this.color="rgba(88,216,84,0.5)"}function Were(t){this.stats={str:12,agi:7,"int":5,cha:3,phys:1,magi:0,maxHP:20},""===t&&(t=randomEntry(["Wolf","Goat","Hellbeast"]));var e="IwNgHgLAHAPgDAxTktW9Lhyxhx8HoHH6YkmrmFlU5JbnZ1N7Xb2LGv11fuecKaWsJyFSmQd0kDhyZh3m5lK1WvUbNmhisaiqNEYaHzaC9ownS+/PD1JWWTLszEHKbnZSmPFd37Z23koIQA==",s="IwNgHgLAHAPgDAxTktWpx0M8TWdaK7F6onkrlVlW422lFzV1F4lOfPHaOves+bHumqj2/Mm0JC0jZnMqFlK1WvUbRM7tvlyK+2pQaThY5Cb04KkwSIVcB1jBJGzzNXnozT8Pxf5KFpohqkA=";switch(t){case"Wolf":this.spriteCompressed=e,this.displayName="Werewolf",this.color="#ac7c00",this.item1=new Claws;break;case"Goat":this.stats.maxHP=22,this.stats.str=9,this.spriteCompressed=s,this.displayName="Weregoat",this.color="#d8d8d8";break;case"Hellbeast":this.stats.maxHP=25,this.stats.str=14,this.stats["int"]=8,this.stats.agi=8,this.stats.magi=1,this.spriteCompressed=s,this.displayName="loathsome, hellish beast",this.shortName="Hellbeast",this.color="#7c7c7c"}}function Mage(t){this.inventory=[],this.stats={str:5,agi:8,"int":12,cha:8,phys:0,magi:2,maxHP:12},this.item1=new Staff("Thunder"),this.item2=new Potion("Health"),this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HgeV7dgEF75K4oEBMuwV5hRJd9WZiLzjpCh3DbCFQfy7da3NJQatSVMdLY0e8/MxapVPHBr7Fde/QcNGJe5UymY2YrdeWrx5peRUacvMvNyCKw4Yo/q/r4yisEKVBZaHJwK9tLafEA==",this.displayName="Wiz",this.color="#0058f8",this.aiType="switch",this.switchTrigger=5}function Item(){this.owner=""}function Buff(t,e){switch(this.selfTargeted=!0,this.itemType="Buff",this.cureChance=3,this.natural=0,this.type="physical",this.targetStat="HP",this.owner=e,this.buffArr=[],this.killStr="from inexplicable causes",this.attackVal=function(){return 0},t){case"Smite":this.killStr="by the hand of the divine";break;case"Aflame":this.killStr="in a conflagration",this.cureChance=3,this.attackVal=function(){return roll("1d3")+Math.ceil(roll("1d5")*this.owner.stats.maxHP/100)},this.attackType="fire",this.sprite="flame",this.color="rgba(248,56,0,0.5)",this.verbs=["burn","roast"];break;case"Poisoned":this.killStr="of internal injuries",this.cureChance=4,this.attackVal=function(){return roll("1d3")},this.attackType="poison",this.sprite="bubble",this.color="#d800cc",this.verbs=["waste","wither"];break;case"Regenerating":this.cureChance=5,this.attackVal=function(){var t=Math.ceil(this.owner.stats.maxHP/12);return-1*roll(t+"d3")},this.attackType="white",this.sprite="poof",this.color="#f8d878",this.verbs=["heal","regenerate"];break;case"Juiced":this.cureChance=2,this.attackVal=function(){return-1*roll("1d2")},this.attackType="poison",this.targetStat="str",this.sprite="bubble",this.color="#f83800",this.verbs=["gain","rage"]}}function Weapon(){this.selfTargeted=!1,this.natural=1,this.buffArr=[],this.uses=!0,this.targetStat="HP",this.itemType="Weapon"}function Punch(){this.uses=!0,this.sprite="poof",this.attackType="physical",this.color="white",this.displayName="nothing but the essentials",this.shortName="Bare Hands",this.verbs=["punch","smack","hit","wallop","slap"],this.attackVal=function(){var t=this.owner.stats.str,e=this.owner.stats.agi;return roll(Math.floor((t+e)/8)+"d3")}}function Sword(t){this.sprite="slash1",this.attackType="physical",this.verbs=["slash","strike","stab","lance","wound","cut"];var e="IwNgHqA+AMt/DFOS18BMw20+7v9g9liDUijtpLsss17pjlgg";switch(this.smallSprite=e,t){case"Iron":this.uses=30,this.breakVerb="breaks on impact",this.displayName="a modest but functional iron blade",this.shortName="Iron Sword",this.color="#008888",this.attackVal=function(){return roll("3d3")-2};break;case"Flame":this.uses=20,this.breakVerb="glows red-hot, shatters,",this.displayName="a shining red sword that smells of sulfur",this.shortName="Flame Sword",this.color="#f87858",this.attackType="fire",this.buffArr=["Aflame",8],this.attackVal=function(){return roll("3d3")-1};break;case"Wood":default:this.flammable=!0,this.breakVerb="splinters into bits",this.uses=25,this.displayName="a wooden sword meant for practice",this.shortName="Wooden Sword",this.color="#f8b800",this.attackVal=function(){return roll("2d3")}}}function Staff(t){this.sprite="kapow",this.attackType="physical",this.verbs=["strike","bludgeon","bash","thwack","smack"];var e="IwNgHqA+AMt/DFOgJmYlx309uu9UtCC9Ttz1LlqlaNiysg==",s="IwNgHqA+AMt/DFOcgTMF9itZ26M91cjs9YzzCryLbpq9HNmVCg==";switch(t){case"Thunder":this.smallSprite=s,this.uses=25,this.breakVerb="splits down the middle",this.displayName="a staff enchanted with electricity",this.shortName="Thunder Staff",this.sprite="bolt",this.attackType="lightning",this.targetStat="HP",this.color="#b8f8d8",this.verbs=["blast","electrocute","zap","smite"],this.attackVal=function(){return Math.floor(1.5*rollHits(this.owner.stats["int"]+"d3",3))};break;case"Wood":default:this.smallSprite=e,this.flammable=!0,this.uses=25,this.breakVerb="snaps like a twig",this.displayName="a solid, wooden staff",this.shortName="Wooden Staff",this.color="#f8b800",this.attackVal=function(){var t=this.owner.stats.str,e=this.owner.stats.agi;return rollHits(t+e+"d5",5)}}}function Claws(t){switch(this.sprite="claws",this.attackType="physical",this.targetStat="HP",this.verbs=["maul","savage","lacerate","wound","cut"],this.smallSprite="IwNgHqA+AMt/DFKcATMxaMK/XPgd0VC59tphSLYqb66bGniX7L0g",t){case"Venom":this.uses=10,this.breakVerb="snaps with a sickening crunch",this.displayName="a pair of fangs with the venom sac still attached",this.shortName="Venom Fang",this.color="#00b800",this.attackType="poison",this.buffArr=["Poisoned",6],this.attackVal=function(){var t=this.owner.stats.str,e=this.owner.stats.agi;return roll(Math.ceil((t+e)/12)+"d4")};break;case"Bone":default:this.uses=15,this.breakVerb="is worn to stumps",this.displayName="a set of sharp bone claws",this.shortName="Bone Claw",this.color="#f0d0b0",this.attackVal=function(){var t=this.owner.stats.str,e=this.owner.stats.agi;return roll(Math.ceil((t+e)/8)+"d4")}}}function Hose(t){switch(this.sprite="splat",this.attackType="physical",this.verbs=["splash","douse"],this.smallSprite="IwNgHqA+AMt/DFOQ4wBMLZp8ZvM1F1c9oj5STZrKSMLp7sH7H1Ny0PTECCk/boP6d8HDnCA=",t){case"Fire":this.uses=15,this.breakVerb=", empty and starting to smell,",this.displayName="a glowing bladder of sorts, hot to the touch",this.shortName="Lava Sac",this.attackType="fire",this.targetStat="HP",this.color="rgba(248,56,0,0.5)",this.verbs.push("ignite","torch"),this.buffArr=["Aflame",3],this.attackVal=function(){return roll("1d3")};break;case"Acid":default:this.uses=30,this.breakVerb="melts into a puddle of goo",this.displayName="a slimy, acidic appendage",this.shortName="Acid Whip",this.attackType="acid",this.targetStat="maxHP",this.color="rgba(88,216,84,0.5)",this.verbs.push("slime","spatter"),this.attackVal=function(){return roll("1d2")}}}function Consumable(){this.selfTargeted=!0,this.natural=0,this.buffArr=[],this.uses=1,this.targetStat="HP",this.attackVal=function(){return 0},this.itemType="Consumable"}function Potion(t){this.uses=1,this.sprite="poof",this.breakVerb="is empty",this.shortName="Potion of ";var e="IwNgHqA+AMt/DFOS5x0ddYAmbXs9gDd9VTZi094qFcdGmc65cMMXF2P2kHmrer2hA===";switch(this.smallSprite=e,t){case"Regen":this.attackType="physical",this.color="#f8d878",this.shortName+="Regen",this.displayName="a fizzy yellowish potion that smells like chalk",this.buffArr=["Regenerating",1],this.verbs=["regenerate"],this.attackVal=function(){return-1*roll("1d6")};break;default:case"Health":this.attackType="physical",this.color="#58f898",this.shortName+="Health",this.displayName="a brilliant green potion, slightly warm to the touch",this.verbs=["heal"],this.attackVal=function(){return-1*this.owner.stats.maxHP}}}function Vial(t){switch(this.uses=1,this.sprite="poof",this.breakVerb="is used-up",this.shortName="Vial of",this.smallSprite="IwNgHqA+AMt/DHQEyuU+wvY3Yt9cDijpDCjzSz0LdhU6MHkmkW3EPrvTe+KQA===",t){default:case"Steroids":this.displayName="a small ampule of dangerous performance-enhancing drugs",this.attackType="poison",this.targetStat="cha",this.color="#f83800",this.shortName+=" Steroids",this.buffArr=["Juiced",1],this.verbs=["inject"],this.attackVal=function(){return roll("1d5")}}}function Effect(){this.sprites={kapow:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJBAjKZahRjVSnQ4o8i/UmTZ/N+5ZwMFs+zHl2pDeItJJmTh0hLIbypi5vNaqBPbAqzKtq9SsFzDJpWN2mhlwtv32512GueYnjLx4Off+HRAA==",slash1:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJpZaAjOdZTXUlfU40zRS5h65e9l9ynb9BwkXSF9RyXtQlYpAhDM6KMC1bnUa+20oyA",blast:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJeAjGfBaTUpRQ4/bTU25S2h41Yk3zxLV07DggaoJRNl2FSq8uovLcxStfOXrCwhSl3iNa5AZUD9x2AdNLicywqNitAh9hmT7Tt4OlvDHgGe/iyqcq7Wvpw6oi7ROPSxVvGk9rBAA==",claws:"GwFgHgTCA+AM8MU5LVvRzXs93/BGAjCYWXiUeddpYnTYwqfA0+1ay15+4bwzZ8ynFkOH8uPCTSpjeM2XIWLypbmjmtVqUSuRbY+nfWNJDZk0cwWra6w7sFbmh5yA",poof:"GwFgHgTCA+AM8MU5LVvRzXs93/mAjASasaRYuUWdtafVTZbI0mwvR5y/Nz8n69B7YWNF9xU6TNlzWHQuSVEVWIfM1bN1DdvSM9+gxkXGmaflxPnWtU7aOSR6809stqQA",splat:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxhAjCduRdWuaVTQw/M/vfTS8h8ex62Tqx2JPjwpi+EkV1GSEAwbMHzqkxZRbq523qo1Z1MlVOn7ewqgc26LnREbvLhoy1ev3cQ7vCA=",bolt:"GwFgHgTCA+AM8MU58CMKOZervM70MQKKJNL3Iqyuo1rqXQcYVRcZw87Vd2+oC+vYU1GVxbSf0lDRcmdPrtxC1gTXYlW6c01klJFYZPJ99WOYtNjwrtrGW7UhyLeDH2qzrTfrr93kAl1MAv2wgA==",flame:"GwFgHgTCA+AM8MU5LVvRzXs93/BaAjIZiaauRZdckVbUvYwsy0w7W7Jyr06358y9ckMTdhPUVkl8Zc+emajxEtatU14i9ZqFVdO+hH1Kt81ad0qZl6xY5m6mh5c0uTzvaLdPfjsZWdoJEEOFecvoODAFhEVGugSbhqX5B1qkh0vFp1nqZCbG5eZIpefmCFQnq1ZWsdbwlaU2NdG0c1a0Vis01TF385fWdWQYlRsNGQWozItOh5EA",bubble:"GwFgHgTCA+AM8MU5FlvRtrM9tvuh6++RZ5FyAjFbiZTeo/PdbYfs4V0jwZZj5sB3ERiE52Y6tNmwpcpouUrVvZeyA===",rain:"GwFgHgTCA+EAwMU5LkEYn1dncOfVzixXwRITOwqStSpuOzsMUccqIZQ6LwOS8+3QZz6IRAllRal6rMblmzaw3BxWqcvTRPXyu+gwvHGtp8gpJ1dTc9ZPVtOW0KG27qd3p7PmPj3EyDEC1MVDRfwiBM0cvCx8jBP4iIRc+NPTHTNiUtiS4ugcYwsi8/NzNIv84xIqgrPqw3KxpZKk5BOVO027apQLfGqc/YfjRnvGnIA=",shield:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJpZ8AjBWlbXbaneQlTROx59ShRK87H48+9Kn0YiBg7sNFiZSXkPLLFI0eNkKyqxErmbk+qbpbr6htaeLXB5upb2SBtuxu1PXBV/ocezXvhevkoYgUH+VqFhkTaxTo6M8YTh0thCQA=",cloud:"GwFgHgTCA+AM8MU5LVvRzXs93hAjAfpkSUkcbJVedWfQ+TVU8zfGxVxRB6T0QE+lAfyQQRLdC1qJJsuZ2KKI3KTTVCVsrYWGrtBliP3HNTShqKnl5q5ZuLRja9NfOGDz/M9s37vAB4rDBLtRhwoSReva60X6xfo7JZn5pPvQKTprK2XFaNlLWhcLFJnYaktWl9jWSlZr1jVbNeVXVtEVNCvr5Zb3tPXxmNYGunSGt/XLT1twDgSYzC5Phy/Or2cgbghO2RkUHyA0YRdinMmV0Z0o3+vc74Y+Md/d7N0xAA==",star:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJpREZlWFaNVpAjKk/ZS4u62Q+58nV2w9hmFgNTi2I0XzQ9Ww2SnlYVVRUsQ1NKSUV47+g9LMPHVzc4T0IbV4hSA===",chaos:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxqAjOeSVeuRHXZdU/KQxaxKWe85hx/X7IBDXjU5t+nJP1rS0FEqykNVXFqs3rhg4sokH92/YfkytRIxKvHrd7YhuW7p5QhNSH7i4Q+C13gaGZLp6hnJujpKiCoxhQT5R9GZiKLIUMcI8qTQinF45ltlAA==",cresent:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJpZ5FmAjDVehJQbc3cg43s4jcqxzjzZJ2/bLVR9Yk0RkEoRUkgqbTEC1fmWcNKOYR0DDxA2JPcdW+CL37LuvVTtXx5R6ZoMgA="},this.color="yellow",this.associatedCharacter=""}function loadButtons(t){for(var e=t.querySelectorAll(".button"),s=0;s<e.length;s+=1)e[s].addEventListener("click",function(t){return function(){var e=t.getAttribute("click-data");currentGame[firstWord(e)](secondWord(e))}}(e[s]))}var __nativeST__=window.setTimeout;window.setTimeout=function(t,e){var s=this,r=Array.prototype.slice.call(arguments,2);return __nativeST__(t instanceof Function?function(){t.apply(s,r)}:t,e)};var intervalRelay="",currentGame=new Game,interfaceElement=document.getElementById("interface"),inventoryCanvases=[document.getElementById("invSprite1").getContext("2d"),document.getElementById("invSprite2").getContext("2d"),document.getElementById("invSprite3").getContext("2d"),document.getElementById("invSprite4").getContext("2d"),document.getElementById("invSprite5").getContext("2d"),document.getElementById("invSprite6").getContext("2d"),document.getElementById("invSprite7").getContext("2d"),document.getElementById("invSprite8").getContext("2d")];Displayable.prototype.constructor=Displayable,Displayable.prototype.draw=function(t,e){var s=LZString.decompressFromBase64(e),r=s.slice(s.indexOf("|")+1),a=s.slice(0,s.indexOf("x")),i=s.slice(s.indexOf("x")+1,s.indexOf("|"));t.clearRect(0,0,a,i),t.fillStyle=this.color;for(var n=0;n<r.length;n+=1){var o=Math.floor(n/a);1==r.slice(n,n+1)?(t.fillStyle=this.color,t.fillRect(n-o*a,o,1,1)):2==r.slice(n,n+1)&&(t.fillStyle=halfBlack(this.color),t.fillRect(n-o*a,o,1,1))}},Location.prototype=new Displayable,Location.prototype.constructor=Location,Character.prototype=new Displayable,Character.prototype.constructor=Character,Character.prototype.updateStatus=function(){this.stats.HP<1?this.stats.HP=0:this.stats.HP>this.stats.maxHP&&(this.stats.HP=this.stats.maxHP),this.displayElement.hpText.innerHTML=this.stats.HP+"/"+this.stats.maxHP;var t=Math.floor(this.stats.HP/this.stats.maxHP*100);this.displayElement.hpBar.style.width=t+"%",this.displayElement.hpBar.className="hp-bar hp-"+10*Math.round(t/10),"Hero"===this.constructor.name&&this.drawInventory(),0===this.stats.HP&&this.die()},Character.prototype.addClass=function(t){this.div.classList.add(t)},Character.prototype.wiggle=function(t,e){this.div.classList.add(t);var s=this;setTimeout(function(){s.div.classList.remove(t)},e)},Character.prototype.equip1=function(t){t.owner=this,this.hand1=t,"Hero"===this.constructor.name&&(document.getElementById("equip1").innerHTML=shorten(t.shortName,17))},Character.prototype.equip2=function(t){t.owner=this,this.hand2=t,"Hero"===this.constructor.name&&(document.getElementById("equip2").innerHTML=shorten(t.shortName,17))},Character.prototype.getEnemy=function(){return"Hero"===this.constructor.name?currentGame.currentMonster:currentGame.playerHero},Character.prototype.defense=function(t){switch(t){case"white":case"black":return this.stats.magi;case"lightning":case"fire":return this.burnItems(),Math.floor((this.stats.magi+this.stats.phys)/2);case"poison":return 0;case"physical":default:return this.stats.phys}},Character.prototype.burnItems=function(){for(var t=[this.hand1,this.hand2],e=t.length-1;e>=0;e--)"undefined"!=typeof t[e]&&t[e].flammable===!0&&(t[e].uses-=roll("1d10"),t[e].uses=t[e].uses>0?t[e].uses:t[e].uses,t[e].breakVerb="is charred to a crisp")},Character.prototype.smite=function(t){this.stats.HP-=t,this.lastHitBy=new Buff("Smite",this).attackObj(),this.updateStatus()},Character.prototype.hit=function(t){intervalRelay="wait";var e=this.defense(t.type),s="undefined"!=typeof this.resists[t.type]?this.resists[t.type]:1;"HP"!==t.targetStat&&(t.natural=0);var r=t.calculated-e<0?0:t.calculated-e,a=Math.ceil((t.natural+r)*s),i=Math.ceil((t.calculated+t.natural)*s),n=0;switch(t.itemType){case"Consumable":n=i;break;case"Weapon":n=a;case"Buff":n=t.calculated<0?i:a}this.stats[t.targetStat]-=n,this.effectController.displayDamage(t.sprite,t.color),this.wiggle("hit",250);var o=randomEntry(t.verbs),h="";switch(this.lastHitBy=t,t.itemType){case"Consumable":case"Buff":t.calculated<0&&(n=Math.abs(n)),h=firstCap(this.selfStr())+" "+this.conjugate(o)+" for "+n+t.targetStat.toUpperCase()+".";break;case"Weapon":h=firstCap(this.getEnemy().selfStr())+" "+this.getEnemy().conjugate(o)+" "+this.selfStr().toLowerCase()+" for "+n+t.targetStat.toUpperCase()+"."}currentGame.log.add(h),this.updateStatus();var c=1;if(t.buffArr.length>1){var l=t.buffArr[0],u=t.buffArr[1],d=rollHits("1d"+u,u)>=1;d&&!this.buffs.includes(l)&&this.stats.HP>0&&(o="are",h=firstCap(this.selfStr())+" "+this.conjugate(o)+" "+l+".",this.addBuff(l),setTimeout(function(){currentGame.log.add(h)},1e3),c++)}"Buff"!==t.itemType&&setTimeout(function(){intervalRelay="Check equip"},1e3*c)},Character.prototype.selfStr=function(){return"Hero"===this.constructor.name?"You":"The "+this.shortName},Character.prototype.conjugate=function(t){return"Hero"===this.constructor.name?t:thirdPerson(t)},Character.prototype.addBuff=function(t){this.buffs.includes(t)||this.buffs.push(t)},Character.prototype.runBuffs=function(){var t="Use equip";if(this.buffs.length<1)return void(intervalRelay=t);var e=this.buffs.slice(),s=this,r=0,a=!1,i={},n=!0,o=setInterval(function(){if(!a&&n){i=new Buff(e[r],s).attackObj(),s.hit(i);var h=roll("1d"+i.cureChance)===i.cureChance;if(h){var c=s.buffs.indexOf(e[r]);-1!==c&&s.buffs.splice(c,1),a=!0,setTimeout(function(){n=!0},1e3)}else r++,setTimeout(function(){n=!0},1e3)}else n&&(s.stats.HP>0&&currentGame.log.add(s.selfStr()+" "+s.conjugate("are")+" no longer "+e[r].toLowerCase()+"."),a=!1,r++);r>=e.length&&!a&&n&&(s.stats.HP<=0&&(t="End round"),clearInterval(o),setTimeout(function(){intervalRelay=t},1e3))},750)},Character.prototype.checkEquip=function(t){var e="";switch(t){case"activate1":e=this.hand1;break;case"activate2":e=this.hand2;break;case"activateOffhand":e=this.offHand;break;default:return void(intervalRelay="End turn")}e.checkExhausted()?(e.exhaust(),setTimeout(function(){intervalRelay="End turn"},1e3)):intervalRelay="End turn"},Character.prototype.runAway=function(){var t=this.calcDodge(),e="",s="";t?(e="Hero"===this.constructor.name?"manage":"manages",s=firstCap(this.selfStr())+" "+e+" to escape!",currentGame.log.add(s),currentGame.currentMonster.addClass("escaped"),setTimeout(function(){intervalRelay="End round",currentGame.switchMonster()},1e3)):(e="Hero"===this.constructor.name?"try":"tries",s=firstCap(this.selfStr())+" "+e+" to flee, but to no avail...",currentGame.log.add(s),setTimeout(function(){intervalRelay="End turn"},1e3))},Character.prototype.activateOffhand=function(){this.useItem(this.offHand)},Character.prototype.equip1Offhand=function(){this.equip1(this.offHand),currentGame.log.add(firstCap(this.selfStr())+" "+this.conjugate("equip")+" the "+this.offHand.shortName.toLowerCase()+"."),this.offHand="",setTimeout(function(){intervalRelay="Check equip"},1e3)},Character.prototype.equip2Offhand=function(){this.equip2(this.offHand),currentGame.log.add(firstCap(this.selfStr())+" "+this.conjugate("equip")+" the "+this.offHand.shortName.toLowerCase()+"."),this.offHand="",setTimeout(function(){intervalRelay="Check equip";
},1e3)},Character.prototype.activate1=function(){"undefined"==typeof this.hand1&&this.equip1(new Punch),this.useItem(this.hand1)},Character.prototype.activate2=function(){"undefined"==typeof this.hand2&&this.equip2(new Punch),this.useItem(this.hand2)},Character.prototype.useItem=function(t){var e=t.attackObj();e.targetCharacter!==this&&e.targetCharacter.calcDodge()?e.targetCharacter.dodge():(t.uses!==!0&&t.uses--,e.targetCharacter.hit(e))},Character.prototype.runTurn=function(t){var e="Hero"===this.constructor.name?"Monster turn":"End round";intervalRelay="Check buffs";var s=this,r=setInterval(function(){if("Check buffs"===intervalRelay)intervalRelay="wait",s.runBuffs();else if("Use equip"===intervalRelay)intervalRelay="wait",s[t]();else if("Check equip"===intervalRelay)intervalRelay="wait",s.checkEquip(t);else if("End turn"===intervalRelay)intervalRelay="wait",clearInterval(r),intervalRelay=e;else if("End round"===intervalRelay)return void clearInterval(r)},250)},Character.prototype.addToInv=function(t){if(this.inventory.length<8)t.owner=this,this.inventory.push(t),this.updateStatus();else if("Hero"===this.constructor.name){var e=this;setTimeout(function(){e.inventoryFull(t)},600)}},Character.prototype.die=function(){intervalRelay="End round",this.addClass("dead");var t="";switch(this.lastHitBy.itemType){case"Consumable":t=this.selfStr()+" died of self-inflicted wounds.";break;case"Buff":t=this.selfStr()+" died "+this.lastHitBy.killStr+".";break;case"Weapon":t="Hero"===this.constructor.name?"You were slain by the "+this.getEnemy().shortName+".":"You slayed the "+this.shortName+"."}currentGame.log.add(t),"Hero"===this.constructor.name?(currentGame["interface"].pause(),setTimeout(function(){currentGame.log.add("You slayed "+currentGame.playerHero.kills+" monsters and found "+currentGame.playerHero.gold+" gold before perishing.")},2e3)):currentGame.playerHero.stats.HP>0&&(currentGame.playerHero.kills++,this.loot(),currentGame.playerHero.kills>=currentGame.currentLocation.switchTrigger?setTimeout(currentGame.switchLocation,2e3):setTimeout(currentGame.switchMonster,2e3))},Hero.prototype=new Character,Hero.prototype.constructor=Hero,Hero.prototype.drawInventory=function(){for(var t=7;t>0;t--)inventoryCanvases[t].clearRect(0,0,16,16);for(var e=this.inventory.length-1;e>=0;e--){var s=inventoryCanvases[e],r=this.inventory[e].smallSprite;this.inventory[e].draw(s,r)}},Hero.prototype.debug=function(){currentGame.log.add("Fire rains from the heavens, lighting everything ablaze!"),this.addToInv(new Sword("Flame")),this.addBuff("Aflame"),this.getEnemy().addBuff("Aflame"),this.effectController.displayDamage("flame","rgba(248,56,0,0.5)"),currentGame.currentMonster.effectController.displayDamage("flame","rgba(248,56,0,0.5)"),this.wiggle("hit",250);var t=this.stats.HP<10?10:this.stats.HP-10;setTimeout(function(){currentGame.playerHero.smite(t),currentGame.currentMonster.smite(12),intervalRelay="End turn"},1e3)},Hero.prototype.possesive=function(){return"your"},Hero.prototype.calcDodge=function(){for(var t=[],e=currentGame.currentMonster.stats.agi-1;e>=0;e--)t.push(!1);for(var s=this.stats.agi/2-1;s>=0;s--)t.push(!0);return randomEntry(t)},Hero.prototype.dodge=function(){this.wiggle("dodge",500),currentGame.log.add("You dodge the "+currentGame.currentMonster.shortName+"'s attack."),intervalRelay="End turn"},Hero.prototype.initialize=function(){this.effectController=new Effect,this.effectController.link(this),this.addToInv(new Sword),this.addToInv(new Potion("Health")),this.equip1(this.inventory[0]),this.equip2(this.inventory[1]),this.gold=0,this.draw(this.canvas,this.spriteCompressed),this.updateStatus()},Hero.prototype.receive=function(t){currentGame.foundItem=t;var e="You find a "+t.shortName+"!";currentGame.dialog.addButton("Take the "+t.shortName,"router takeFoundItem"),currentGame.dialog.addButton("Leave it","router closeDialog"),currentGame.dialog.setText(e),currentGame.dialog.open()},Hero.prototype.inventoryFull=function(t){for(var e="You don't have room in your knapsack for the "+t.shortName+"!<br> Would you like to drop something?",s=0;s<=this.inventory.length-1;s++)currentGame.dialog.addButton("Drop your "+this.inventory[s].shortName,"dropItem "+s);currentGame.dialog.addButton("Leave the "+t.shortName+" behind","router closeDialog"),currentGame.dialog.setText(e),currentGame.dialog.open()},Monster.prototype=new Character,Monster.prototype.constructor=Monster,Monster.prototype.possesive=function(){return"the "+this.shortName.toLowerCase()+"'s"},Monster.prototype.ai=function(){switch("undefined"==typeof this.aiType&&(this.aiType="simple"),this.aiType){case"simple":return"activate1";case"random":return Math.random()>.5?"activate1":"activate2";case"switch":return"undefined"==typeof this.switchTrigger&&(this.switchTrigger=Math.round(this.maxHP/2)),this.stats.HP>=this.switchTrigger?"activate1":"activate2";case"buffer":return"Punch"!==this.hand1.constructor.name?"activate1":"activate2"}},Monster.prototype.announce=function(){var t="";t=currentGame.previousMonsterName===this.displayName?"another ":-1!=="AEIOU".indexOf(this.displayName.slice(0,1))?"an ":"a ";var e="It's "+t+this.displayName.toLowerCase()+"!";currentGame.log.add(e),""===this.shortName&&(this.shortName=this.displayName),this.displayElement.name.innerHTML=this.shortName},Monster.prototype.appear=function(){this.announce(),this.inventory=[],"undefined"!=typeof this.item1&&this.addToInv(this.item1),"undefined"!=typeof this.item2&&this.addToInv(this.item2);var t=this.inventory[0]?this.inventory[0]:new Punch,e=this.inventory[1]?this.inventory[1]:new Punch;this.equip1(t),this.equip2(e),this.effectController=new Effect,this.effectController.link(this),this.draw(this.canvas,this.spriteCompressed),this.stats.HP=this.stats.maxHP,this.gold=roll("1d20"),this.updateStatus()},Monster.prototype.calcDodge=function(){for(var t=[],e=currentGame.playerHero.stats.agi-1;e>=0;e--)t.push(!1);for(var s=this.stats.agi/2-1;s>=0;s--)t.push(!0);return randomEntry(t)},Monster.prototype.dodge=function(){this.wiggle("dodge",500),currentGame.log.add("The "+this.shortName+" dodges your attack."),intervalRelay="End turn"},Monster.prototype.loot=function(){var t=rollHits("1d1",1)>0,e="You found ",s=this.inventory.length>0?randomEntry(this.inventory):!1,r=this;e+=t&&s?"a "+s.shortName+"!":this.gold+" gold!",setTimeout(function(){currentGame.log.add(e),t&&s?currentGame.playerHero.receive(s):currentGame.playerHero.gold+=r.gold},1e3)},Axedude.prototype=new Monster,Axedude.prototype.constructor=Axedude,Ball.prototype=new Monster,Ball.prototype.constructor=Ball,Scamp.prototype=new Monster,Scamp.prototype.constructor=Scamp,Skele.prototype=new Monster,Skele.prototype.constructor=Skele,Snek.prototype=new Monster,Snek.prototype.constructor=Snek,Jelly.prototype=new Monster,Jelly.prototype.constructor=Jelly,Were.prototype=new Monster,Were.prototype.constructor=Were,Mage.prototype=new Monster,Mage.prototype.constructor=Mage,Item.prototype=new Displayable,Item.prototype.constructor=Item,Item.prototype.checkExhausted=function(){return this.uses<=0},Item.prototype.exhaust=function(){if(this.uses!==!0){this.owner.hand1===this?this.owner.equip1(new Punch):this.owner.hand2===this&&this.owner.equip2(new Punch);var t=this.owner.inventory.indexOf(this);this.owner.inventory.splice(t,1),this.owner.updateStatus();var e=firstCap(this.owner.possesive())+" "+this.shortName.toLowerCase()+" is "+this.breakVerb+" and discarded.";currentGame.log.add(e)}},Item.prototype.target=function(){return this.selfTargeted?this.owner:this.owner.getEnemy()},Item.prototype.attackObj=function(){var t={};return t.targetCharacter=this.target(),t.natural=this.natural,t.calculated=this.attackVal(),t.type=this.attackType,t.sprite=this.sprite,t.color=this.color,"Punch"===this.constructor.name&&"Hero"!==this.owner.constructor.name&&(t.color=this.owner.color),t.verbs=this.verbs,t.itemType=this.itemType,t.selfTargeted=this.selfTargeted,t.buffArr=this.buffArr,t.killStr=this.killStr,"Buff"===this.itemType&&(t.cureChance=this.cureChance),this.owner.buffs.includes("Aflame")&&"Weapon"===this.itemType&&(t.buffArr=["Aflame",3]),"physical"===this.attackType?t.targetStat="HP":t.targetStat=this.targetStat,t},Item.prototype.invDialog=function(){if(currentGame.foundItem="","Hero"===this.owner.constructor.name){var t=this.shortName+":<br>"+firstCap(this.displayName)+".";if(this.owner.hand1===this||this.owner.hand2===this){var e=this.owner.hand1===this?"right":"left",s="<br><br> It is at the ready in your "+e+" hand.";t+=s}else switch(this.itemType){case"Consumable":currentGame.dialog.addButton("Use without equipping","runRound activateOffhand");case"Weapon":var r="Punch"!==this.owner.hand2.constructor.name?"instead of "+this.owner.hand2.shortName:"in your left hand.",a="Punch"!==this.owner.hand1.constructor.name?"instead of "+this.owner.hand1.shortName:"in your right hand.";currentGame.dialog.addButton("Equip "+a,"runRound equip1Offhand"),currentGame.dialog.addButton("Equip "+r,"runRound equip2Offhand")}this.owner.offHand=this;var i=this.owner.inventory.indexOf(this);currentGame.dialog.setText(t),currentGame.dialog.addButton("Drop this "+this.shortName,"dropItem "+i),currentGame.dialog.addButton("Cancel","router closeDialog"),currentGame.dialog.open()}},Buff.prototype=new Item,Buff.prototype.constructor=Buff,Weapon.prototype=new Item,Weapon.prototype.constructor=Weapon,Punch.prototype=new Weapon,Punch.prototype.constructor=Punch,Sword.prototype=new Weapon,Sword.prototype.constructor=Sword,Staff.prototype=new Weapon,Staff.prototype.constructor=Staff,Claws.prototype=new Weapon,Claws.prototype.constructor=Claws,Hose.prototype=new Weapon,Hose.prototype.constructor=Hose,Consumable.prototype=new Item,Consumable.prototype.constructor=Consumable,Potion.prototype=new Consumable,Potion.prototype.constructor=Potion,Vial.prototype=new Consumable,Vial.prototype.constructor=Vial,Effect.prototype=new Displayable,Effect.prototype.constructor=Effect,Effect.prototype.link=function(t){this.associatedCharacter=t,this.damageElement=t.div.getElementsByClassName("damage-sprite")[0],this.damageCanvas=this.damageElement.getContext("2d")},Effect.prototype.displayDamage=function(t,e){this.color=e,this.damageElement.classList.add("active",t),this.draw(this.damageCanvas,this.sprites[t]);var s=this;setTimeout(function(){s.clear()},500)},Effect.prototype.clear=function(){this.damageElement.className="damage-sprite"},loadButtons(document),currentGame.initialize();