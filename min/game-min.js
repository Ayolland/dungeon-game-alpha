function randomEntry(t){return t[Math.floor(Math.random()*t.length)]}function plinko(t,e){if("undefined"!=typeof t&&""!==t)return t;var s=e!==[]?randomEntry(e):"";return s}function roll(t){for(var e=t.slice(0,t.indexOf("d")),s=t.slice(t.indexOf("d")+1),i=0,a=e-1;a>=0;a--)i+=Math.floor(Math.random()*s)+1;return i}function rollHits(t,e){for(var s=t.slice(0,t.indexOf("d")),i=t.slice(t.indexOf("d")+1),a=0,r=s-1;r>=0;r--){var o=roll("1d"+i);(o>=e||o===i)&&a++}return a}function thirdPerson(t){switch(t){case"bash":case"punch":case"slash":case"splash":t+="es";break;case"do":t+="es";break;case"are":t="is";break;default:-1!==t.indexOf(" ")?t=firstWord(t)+"s "+secondWord(t):t+="s"}return t}function firstCap(t){return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}function shorten(t,e){return t.length>e&&(t=t.substring(0,e-4)+"..."),t}function firstWord(t){return t.slice(0,t.indexOf(" "))}function secondWord(t){return t.slice(t.indexOf(" ")+1)}function halfBlack(t){var e=0,s=0,i=0,a=1;if("#"===t.charAt(0))e=parseInt(t.substring(1,3),16),s=parseInt(t.substring(3,5),16),i=parseInt(t.substring(5,7),16);else{if("r"!==t.charAt(0))return"rgba(127,127,127,1)";var r=t.slice(5,-1).split(",");e=r[0],s=r[1],i=r[2],a=r[3]}return e=(e/2).toFixed(),s=(s/2).toFixed(),i=(i/2).toFixed(),a=((a+1)/2).toFixed(1),"rgba("+e+","+s+","+i+","+a+")"}function Game(){this["interface"]={element:document.getElementById("interface"),pause:function(){this.element.classList.add("wait")},unpause:function(){this.element.classList.remove("wait")}},this.log={element:document.getElementById("gameLog"),add:function(t){this.element.innerHTML+="<p>"+t+"</p>",this.element.scrollTop=this.element.scrollHeight}},this.dialog={element:document.getElementById("dialog"),message:document.getElementById("dialog-text"),buttons:document.getElementById("dialog-buttons"),open:function(){currentGame["interface"].pause(),loadButtons(this.element),this.element.classList.add("active")},setText:function(t){this.message.innerHTML=t},addButton:function(t,e,s){s=s+""=="undefined"?"":s;var i="<a class='button dialog "+s+"' click-data='"+e+"'>"+t+"</a>";this.buttons.innerHTML+=i},close:function(){this.element.classList.remove("active");var t=this;t.message.innerHTML="",t.buttons.innerHTML="",setTimeout(function(){currentGame["interface"].unpause()},500)}},this.router=function(t){switch(this.dialog.close(),t){case"unEquipleft":this.playerHero.equip2(new Punch);break;case"unEquipright":this.playerHero.equip1(new Punch);break;case"takeFoundItem":this.playerHero.addToInv(this.foundItem);break;case"takeLootedItem":this.playerHero.addToInv(this.foundItem);case"newMonster":this.switchMonster();case"closeDialog":default:currentGame.playerHero.offHand=""}},this.currentLocation=new Location,this.playerHero=new Hero("TEMP"),this.currentMonster=new Monster,this.previousMonsterName="",this.initialize=function(){currentGame.playerHero=new Hero("Sandra"),currentGame.currentMonster=new Monster,currentGame.previousMonsterName="",this.switchLocation(),this.playerHero.initialize(),document.getElementById("headsdown").addEventListener("click",function(t){return function(){t.infoDialog()}}(currentGame.playerHero))},this.enterMonster=function(t){this.previousMonsterName=this.currentMonster.displayName;var e=firstWord(t),s=secondWord(t);s===t&&(e=t,s="");var i=new window[e](s);i.div.className="",("inanimate"===i.aiType||"mimic"===i.aiType)&&i.div.classList.add("inanimate"),i.appear(),currentGame.currentMonster=i},this.itemFromString=function(t){var e=firstWord(t),s=secondWord(t);return s===t&&(e=t,s=""),new window[e](s)},this.switchMonster=function(){if(currentGame.currentLocation.switchTrigger<=0)currentGame.crossroadDialog();else{var t=randomEntry(currentGame.currentLocation.monsterArray);currentGame.enterMonster(t)}},this.validLocations=["Dungeon","Volcano","Forest","Graveyard","Mine"],this.crossroadDialog=function(){var t=currentGame.currentLocation.shortName,e=new Location(currentGame.differentLocation([t])),s=new Location(currentGame.differentLocation([t,e.shortName])),i="You come to a crossroads.<br><br>";i+="One path leads to "+e.displayName+".<br><br>",i+="The other path heads towards "+s.displayName+".<br><br>",i+="What path do you choose?",currentGame.dialog.addButton("Head for the "+e.shortName,"switchLocation "+e.shortName),currentGame.dialog.addButton("Take the path to the "+s.shortName,"switchLocation "+s.shortName),currentGame.dialog.setText(i),currentGame.dialog.open(),currentGame.currentMonster.addClass("dead")},this.differentLocation=function(t){var e=currentGame.validLocations.slice(0);if(t.length>0)for(var s=t.length-1;s>=0;s--)e.splice(e.indexOf(t[s]),1);return randomEntry(e)},this.switchLocation=function(t){currentGame.dialog.close(),currentGame["interface"].pause(),t="undefined"==typeof t?randomEntry(currentGame.validLocations):t,currentGame.currentLocation=new Location(t),document.body.className=currentGame.currentLocation.shortName,document.getElementById("level-text").innerHTML="LVL: "+currentGame.currentLocation.shortName,currentGame.currentLocation.switchTrigger=5+roll("1d3"),currentGame.currentLocation.draw(currentGame.currentLocation.canvas,currentGame.currentLocation.spriteCompressed),currentGame.currentLocation.canvas.fillRect(0,40,160,50),currentGame.log.add("You enter the "+t+"..."),setTimeout(function(){currentGame.switchMonster(),currentGame["interface"].unpause()},2e3)},this.everyoneIsAlive=function(){return this.playerHero.stats.HP>0&&this.currentMonster.stats.HP>0},this.runRound=function(t){this.foundItem="",this.dialog.close(),intervalRelay="Player turn";var e=setInterval(function(){if("Player turn"===intervalRelay)intervalRelay="wait",currentGame["interface"].pause(),currentGame.everyoneIsAlive()?currentGame.playerHero.runTurn(t):intervalRelay="End round";else if("Monster turn"===intervalRelay){intervalRelay="wait";var s=currentGame.currentMonster.ai();currentGame.everyoneIsAlive()?currentGame.currentMonster.runTurn(s):intervalRelay="End round"}else"End round"===intervalRelay&&(clearInterval(e),intervalRelay="wait",currentGame.playerHero.stats.HP>0&&currentGame["interface"].unpause())},500)},this.inventoryRouter=function(t){var e=this.playerHero.inventory[t-1];"undefined"!=typeof e&&e.invDialog()},this.dropItem=function(t){this.dialog.close();var e=this.playerHero.inventory[t];e.destroy(),this.foundItem.sprite&&this.playerHero.addToInv(this.foundItem)}}function Displayable(){this.validTypes=[]}function Location(t){switch(this.canvas=document.getElementById("level-sprite").getContext("2d"),this.shortName=t,t){case"Dungeon":this.spriteCompressed="BwBgHgLCA+CM8MU5LVvRzCQi3/qORxJ2JuuBV1Z5xNDjTzLjOsFlhKnXrzFDojod2ddvwFCu40fXKSpg+LPFEhittLIqkvBX00FBM9WpESdGo8hO195+rvXabw13Idq5K0hsNGdtJi3q6UYs7WbtoBUU7y4WbhUW5BngmO6aKR0ZGmBo6JITm5aYXmWRJpNmUWfnEu7rGaQXwy6UkVHrkeGRWFJT3Knh11Xe09ur4hmaQKMZPDffPWhm3dgRtT0zPL2QvRteVjEXbN/K3Hqgl5pWFXJ5y3h/fl7u9xW4rV9iM+c8UDqlep0vLsvM9gUtvJ1Kn4fjVVjCTA4dtgvpIjqjGjxuMNEfjcW0ClVkoSWiCSflQU8gQSGgD2stlKdzgIUfYkilbJZJsZ5Gwut9ZPzkZlWG8dgogA==",this.displayName="a musty, dark and ancient dungeon, full of cobwebs and lurking monsters",this.monsterArray=["Chest","Axedude","Ball Goo","Skele Bones","Skele Footman","Mage","Jelly"];break;case"Volcano":this.spriteCompressed="BwBgHgLCA+CM8MUpJWpWz6308/sWBxJuRiIhWO6ZupF5peGTC1eLhD+Ht7fSgLZV6VfjlE9kg2XK5Txk7rSHTW8zW1XVGQ/uuFatRpQtOGZus8bJrlBvWssantxwedXHLuhs1iAhTM5r5eRnKBQezM0b7cBCYJesHEXuHx3pG8lM4ZUX6ZidmJij4FcUX+1qWeaWn5mSXeKLHFjS5MHQrlMSGhhgM5fCQdbiIMyqM9vcnSM+qzbhj1nRljlrPdYflLi43bO6NFU627J8fxuZfhGyGXm3uKMU8POYP2kzIVg22TdV8+j8eKdvl9JHcIalNkDhg9VPNxND5ulpuU8qD2n5XnZeKtPOlMVkOPtdgdscM9kQSf1Kb0JHMIh5BDYMSy7CMwT9jJyeXztMjWazqcyAvyWKiObj5P8ablOMSaRyFsKBhMmrJVWzleqqnT3Di9SdsJq7kbzfR5aggA==",this.displayName="a fiery volcano flowing with glowing magma, and wandered by hellish sprites",this.monsterArray=["Chest","Axedude","Ball Fire","Skele Bruiser","Skele Flaming","Were Hellbeast"];break;case"Forest":this.spriteCompressed="IwNgDAHgLGA+ZmE5TEOOhiUrVj+ORWJhq2OpFlBtZxBm9R5V6y7lpLrjtPeJpx6M2IjlRH5p1GiVHjWYxcpZC8U3vPFtuapc1yCNArYa67huA+bq3rgvjstXiqrgpUY+9m5Of+DKKyDMK+we7WEa6oBl5hMUYuptEhsZFy2okSyQF6oYH6etl++QIZSdpqxkwqLmkUMiUV5BH8UvX6Zmnejfbq7D053FUcEp6hceVt3nnyo7GtC4sDPauKw01W1NjLs7tlRjMbYoc7SkGW5TUlmwNyFiEHNdfRG29ns8MdLXaH11tXLJ/nd+jchpV1jRIUVdK97nV5iCdntwYkZMETiNkTCCr9MMc5lMojZYfi0ISfoNliiaaCOulCgC/g07kE3tNekzqrUnNCOWM/Az6Yj2oY+kyJXtWiKAnygaDgbK3Iqsd0npDtsqPKU1al2QKxjdhYbNJjxftuRTueMhSdShrnnTjZzTYirZrHZSjnb3qkNdqViClm7LlcHqGndkCb9BbkHL6ovMflzpW5w2GcQohtJvQCWlGYk6vpMXViM9CKsWc708zy4V0q3E1rWbemK0mbVGSwmy3MC6TG8mk/w248Gyq292lVzB+6Jx4xy8Z1k0+Ou4y08vK4Rg+2m6nwhNBZ58hCfHvLUe6RdMYsU2Or+fbz6CXf3qsGhTj1SVXRiWqVbfmu3w6k4Z51ISfRPh+4oSsS55Qveb5rtBf7gfQiF1sOvhoWBu6YfEwY4ay6EkqeYSwQsuwUV0YHkau5zlswNGrnRjRmhR8HuuyxgniSHEpFxOTMbxEwBuB/HnJwwG3DKKR7txgn3rO6S8HqCkgVoXipoG1Q6ABD46Y4iYmkO17UZc6mbPanGPu+KkrNZhl0exl7tPyRQebafoGoezhCV5RbPgZDi2OFpEoq8vkMtG6KRT66YxbFIVJX5BxEj4PZBclfLkZamW5s+1rJVmnawfxxm5WVcYhTJvk0Q1M6eTKb65QFpXNflo7fu1Zl9aFA0DalfUjUNrnjZNU3TTNs0sEAA=",this.displayName="a murky forest dappled with leafy shadows and populated with wild, untamed creatures",this.monsterArray=["Chest","Axedude","Scamp","Were Wolf","Skele Archer","Skele Monk","Snek"];break;case"Graveyard":this.spriteCompressed="IwNgDAHgLGA+wMU5LVjKzn3HXrCGBxJuRp2GeOB5F9ZDKV+1Ny7TFdXZbO+Zp2I9+fYb1zjWYsSVFtpkjtIGzF86lObblSGQfUy0/HoQnKWppaYkG9XQatVWt+tWYcj2RrbZdevMK+hqEWgd4citb+4Qxu8bYhSQmWTvQxKX7WEXJRSYzuyXmBGvku6eZZHhGESkUeqfnZ0Z6W9YitZUJdbm1BjbKahbTOub3impUmOV6Z3SZRtK5xTPNNQktYg6He6yuC0Z0+flVhVss2sQmzTjnZAd3Fjzd1x+lE5PuDDTsHK503mc6J93r1zi9wT9lv06t9/pCWkjYXwRBVrtV/hiUdwEZi/tj/HN8fDCSlAT0LJ8oVjSaSgb80MDyfDERC7Colqzuc9Mjp9Jt5pMWedDOi3tTQdp2QVkRMRQIJXClc4yXjeUNKhcqBKNTS2X8pFrUTrpcVdrK5YdWCMGgzGPrLaKATtbUaNszrY69X0Pe6bUUDervRoFoCjoG1UHo4rdBTTu5/VaYxrpfyE8ck1a1bF3YUWCoI4Lac7zTqaKDgv644mCeiy8ZOLGBUX7QSc+sHSD7Vma03JSHkWbbWo9KPwz6LeYRwW0iPPWKWV3l1LtrOuavF07XCvTc3KNN8yNk/th+WHbUCwPDafqUa8ziMheg4qvc/12s/dPXyETdaV6ijiHrWV6/uWhwAT2tQwkO4EVpBNbQdsiL5gGqwDI+OidhWaGYRk6EHsYJpYXhSGXI2AYtqRZGUH+gE0biQF0cBDGLJ+gGmqxXE1PeXHcdq1HtNwiR0XxUHYAMYlSVs0myXJ/JrPJjhBEpqlqepGmaVp2k6bpen6QZgRAA===",this.displayName="a lonesome, rainswept graveyard, lit only by lightning and haunted by wicked undead spirits",this.monsterArray=["Chest","Were","Skele","Skele","Mage"];break;case"Mine":this.spriteCompressed="IwNgDAHgLGA+wMU5LVvRzXs93/BhRxJpZ5FlV1Ntd9DjTzLrb7HnX3PvfwYJIITCyo0QP4lx7MIPlUFc2YgljJ9GSgWUdyLXT3k1Q46bTLVeCZdQ2zF3RhOlLc2wJf4P74R4eOrl5CwdbKvr6q/rjuURHy0YSJ+qFJsYbx6YqZycZZtDkp3rY5kbqlJbkWaoVBKbFlGmmeES1ZVdrirZmexF3hjSKpdiED7X0JFW7DnUNTCX1xY/ZJSw3pM9U9kw1EO+FtrXtz+yWLhz0ix/PxezeRm9prl49PJ7VNYRcVn9bfpb0CP0AVdVu9LqC/v9Cq9TPc3EDRiDfjgajtARQHuszt4lm18eV8f5Yb98vlzkd3lZcVS1pDpD5iXkQjRBoMUc56jZycyok59PShmlgSc+c1RQSWuLzCYSccGXE5mK7oqpULpFJqDVBXKBTK9ZrDUbjSbTWbzRbLVbrTbbXb7Q7HU7nS7XW73R7PV7vT7fX7/QggA=",this.displayName="an abandoned mineshaft leading deep into the earth, now the lair of many sinister beasts",this.monsterArray=["Chest","Skele Footman","Were Goat","Jelly","Snek"]}}function Character(){this.buffs=[],this.resists={},this.immunities=[],this.naturalResists={},this.naturalImmunities=[],this.inventory=[],this.armor=new Nude,this.accessory=new Nothing,this.hand1=new Punch,this.hand2=new Punch}function Hero(t){this.div=document.getElementById("hero"),this.canvas=document.getElementById("hero-sprite").getContext("2d"),this.name=t,this.displayElement={hpText:document.getElementById("hero-hp-text"),hpBar:document.getElementById("hero-hp-bar"),name:document.getElementById("hero-name")},this.displayElement.name.innerHTML=t,this.unlucky=0,this.stats={str:8,agi:8,"int":8,cha:8,phys:0,magi:0,block:0,maxHP:50},this.stats.HP=this.stats.maxHP,this.kills=0,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNfcY267a6EbHGlkkp6VVJ4EnmIOOs5maVc3vWt1kVQfSFpBI/FOkzZc+QsUJJqFUOYdOmrdTY7RbZXQbcKG8bwos+9ATZZjVfKkA===",this.color="white",this.buffs=[]}function Monster(){this.div=document.getElementById("monster"),this.canvas=document.getElementById("monster-sprite").getContext("2d"),this.shortName="",this.displayElement={hpText:document.getElementById("monster-hp-text"),hpBar:document.getElementById("monster-hp-bar"),name:document.getElementById("monster-name")},this.buffs=[],this.inventory=[]}function Axedude(t){this.stats={str:10,agi:5,"int":5,cha:2,phys:0,magi:0,maxHP:16},this.spriteCompressed="IwNgHgLAHAPgDAxTktW1xPGdx2u5IF5yF4BMZZCBx1tdODxTtpmGWJKbNnL/Xq3wdqNQh1I8qY8UVlScnaelVr1GzVu07VAviX3jJUscEpFpDRXmb5hzK3RPyTsoe6FOjxkfZXGNrbyaGbKTEA==",this.displayName="Axedude",this.color="#f8d878",this.item2=new Axe,this.item1=new Vial("Steroids"),this.garment=new Plate("Brass"),this.trinket=new Ring("Brass"),this.aiType="buffer",this.purseStr="2d20",this.lootChance=10,this.common=["Food","Axe Brass","Ring Brass"],this.uncommon=["Vial Steroids","Plate Brass"],this.rare=["Vial Opiates","Food Spinach"]}function Ball(t){this.validTypes=["Goo","Fire"],t=plinko(t,this.validTypes),this.stats={str:7,agi:7,"int":1,cha:1,phys:0,magi:1,maxHP:15};var e="IwNgHgLAHAPgDAxTktW9HNe54fd6HBpGkpEBMwVhyhVDtipFrZCl1XTc+ejfJMVK1izDuzF1ewrGKnoFuHCtVr1GzVvU8SIvSKUzD+IZyJn63HiJoWJxsguGHeQifaNvByt7+zAQA===",s="IwNgHgLAHAPgDAxTktWxx0YZrTi7qYHFrElyH7kmnW22Ua0BMwbBTOJbvj3PFhwrN2Y4clZiR9BlVkyynPCtVr1GzVu06t8rLn3ZKR/CbooaF6uYry5jQg8eiec1+IYLhyj+8nOSl4GvkA==";switch(this.purseStr="1d10",this.lootChance=12,this.common=["Axe Brass","Sword Iron"],this.uncommon=["Vial Opiates","Ring Brass"],t){case"Goo":this.spriteCompressed=e,this.displayName="floating ball of dripping ooze",this.shortName="Gooball",this.color="#d800cc",this.rare=["Bow Poison"];break;case"Fire":this.naturalResists={fire:-.5},this.spriteCompressed=s,this.displayName="floating orb of fire",this.shortName="Fireball",this.color="#f83800",this.item1=new Hose("Fire"),this.trinket=new Ring("Fire"),this.aiType="random",this.uncommon=["Bomb Fire"],this.rare=["Sword Fire","Ring Fire"]}}function Chest(t){switch(this.validTypes=["Wood","WoodMimic"],t=plinko(t,this.validTypes),this.stats={str:0,agi:0,"int":0,cha:0,phys:0,magi:0,maxHP:10},this.aiType="inanimate",this.naturalResists={physical:10},this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNez3f8FoBMwRZ5pyJ5N1S1tZliwrb7r9pT3ditrWvUZD+Iml3HNCM2XPkLFSvKOKCG5KmxLdBW9julwdh7Vp6C9LDuukabwYRV5HxEsW6KS3GGsyA==",this.purseStr="5d20",this.lootChance=20,t){case"WoodMimic":this.color="#503000",this.displayName="wooden chest",this.shortName="Wood Chest",this.revealedName="Mimic",this.aiType="mimic",this.stats.phys=2,this.stats.magi=1,this.stats.str=8,this.stats.agi=8,this.naturalResists={},this.item1=new Claws("Bone"),this.common=["Potion","Plate Brass","Bomb"],this.uncommon=["Sword","Cloth Robes","Food","Ring"],this.rare=["Sword Fire","Bow Poison","Staff Thunder"];break;case"Wood":default:this.displayName="wooden chest",this.shortName="Wood Chest",this.color="#503000",this.common=["Food","Potion"],this.uncommon=["Sword","Cloth Robes","Food","Ring","Plate"],this.rare=["Sword Fire","Bow Poison","Staff Thunder"]}}function Jelly(t){this.stats={str:1,agi:10,"int":0,cha:0,phys:4,magi:0,maxHP:20},this.naturalResists={fire:1.25},this.item1=new Hose("Acid"),this.aiType="random",this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNwEy7/5bYYk07JI0q8xfPYOhS6spqk5mnd6tn17vw58hXZqL7jegnpRpEp03A365a5OgSzaduvfoOGjFTXkJCGFC1xyaGWxSuGPi4jRY4v2yj66+tOa39ObmCmBVUxDVMaIA===",this.displayName="quivering, gelatinous cube",this.shortName="Box Jelly",this.color="rgba(88,216,84,0.5)",this.purseStr="3d20",this.lootChance=19,this.common=["Potion","Ring Brass","Bomb","Buckler"],this.uncommon=["Sword","Cloth Robes","Food","Ring","Plate"],this.rare=["Sword Fire","Bow Poison","Staff Thunder"]}function Scamp(t){this.stats={str:2,agi:12,"int":10,cha:8,phys:0,magi:1,maxHP:10},this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HNbcY2G7a6EbHFYmll47WVI1kHpNWu170qU2q/P5BQ4SNFjxEyVypFybOTMx0WdfokZy1ydhwV9C0hry3rtk8xcuIgA=",this.displayName="Scamp",this.color="#b8f818",this.item1=new Potion("Regen"),this.aiType="random",this.purseStr="3d10",this.lootChance=12,this.common=["Food","Potion","Ring Wood"],this.uncommon=["Bow","Cloth Shirt","Staff Wood","Ring Alert"],this.rare=["Vial Steroids","Food Spinach"]}function Skele(t){switch(this.validTypes=["Footman","Archer","Monk","Bruiser","Flaming","Bones"],t=plinko(t,this.validTypes),this.stats={str:6,agi:6,"int":6,cha:2,phys:0,magi:0,maxHP:12},this.color="#f0d0b0",this.naturalResists={fire:1.25},this.purseStr="1d10",this.lootChance=5,this.common=["Food Rotten","Ring Wood"],this.uncommon=["Sword Iron","Potion Health"],this.rare=["Plate Brass"],t){case"Footman":this.stats.maxHP=14,this.stats.str=8,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOGn3f7B5JGJHnFlV6mFwX2PWrklnGtX2ef5P99KLNukpC+CcSK5ZZc+QsVLlKjFIGSCbWiQ4VxHJjuYMcYjZON7257rV4jDKJ6JnC3ziZ5JA==",this.displayName="Skelebones Footman",this.item1=new Sword("Wood"),this.item2=new Buckler("Wood"),this.garment=new Cloth("Rags"),this.aiType="random";break;case"Archer":this.stats.agi=10,this.spriteCompressed="IwNgHgLAHAPgDAxTktW4aUY5xP/pLaFFzA57lXVWl5kIWPLVZ2YFlOn62oWdcgksw7t+4tpNwzZc+QsVKps4qtHd69TaO3caB8uLX6WfYzM5GJvayuETdInVqcq3knEA",this.displayName="Skelebones Archer",this.item1=new Bow("Wood"),this.rare=["Bow Poison"];break;case"Monk":this.stats.agi=16,this.stats["int"]=9,this.stats.magi=1,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOGn3f7B74JFnGLE55ErVzkN1PMkNWuMuGkb3e4O6ChVa9hbLFOkzZc+QsUTUogUlHVV3crTb9d6po1X9J49pU5lzhmn11bDNsWrOO1wIA=",this.displayName="Wise, Old Skelebones",this.shortName="Skelebones Monk",this.item1=new Staff("Wood"),this.garment=new Cloth("Rags"),this.rare=["Vial Steroids"];break;case"Bruiser":this.stats.maxHP=18,this.stats.str=10,this.stats.phys=1,this.spriteCompressed="IwNgHgLAHAPgDAxTktW9biKxux+o5JHIl55kXb40pFY4Gnk0PnbulML28mO0KldvUw9c/DJPTSxxXAsVLlK1WvUdxE7vOaFmOnn0G6WRui1psOwk5252BTO5tEWtMzXI/7T77EA=",this.displayName="Skelebones who thinks he's a badass",this.shortName="Skelebones Bruiser",this.item1=new Sword("Iron"),this.item2=new Buckler("Iron"),this.garment=new Cloth("Rags"),this.aiType="random",this.rare=["Sword Flame","Ring"];break;case"Flaming":this.stats.maxHP=20,this.spriteCompressed="IwNgHgLAHAPgDAxdhNW4KVqRj3GYBMe+CwxxW+55xpNld1uGh9yZVqmuH2XBdASoC+LMuz6kx0qXKGDJEpctlr1GzVvaj+unMhLTWR6hVPoKTfuZr0W+iVguDx+3aJEiF4+Qb/cikqOciECjuFAA",this.displayName="Skelebones who is on fire",this.shortName="Flaming Skelebones",this.trinket=new Ring("Flame"),this.color="#ff5000",this.rare=["Sword Flame","Bomb Fire"];break;case"Bones":this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HPOFxPc7D7pGnGqEJFqGlzlINUrHXPZV30nsb5Mc8fRsKE8RuSVOkzZc+Qt5YBFeirxl13fitrVdqwWrESySwVu7mWJw9Ym2jVIA",this.displayName="Skelebones"}}function Snek(t){this.validTypes=["Big","Small","Sleeper"],t=plinko(t,this.validTypes);var e="IwNgHgLAHAPgDAxTktW9HNez3vgHCaGHolFFolbU0HakaWOqWItJvluff14DBQ4SNFjxEhh1bky1HslpNpVfsTWLFGzloUIuslHzVA==",s="IwNgHgLAHAPgDAxTktW9HPOD4HcHrABMpxuqBFeKJZ5RVmdD+hzpNbOaXcFtWj2xIqA/njFMEU6VnkLFS5StVqhw3mKL1xo7X0QtOjdjpPdN5w1qsyNlByKNSXE2Vw8CgA==",i="IwNgHgLAHAPgDAxTktW9HNez3uBMwhmRpwwahFc51KRO5B+jTGd+xqdCt31pQi3q0hDPBMlTpM2XPkLsYkmLYoqvNcnFYtmTq3Q84nY4mN8RvMcO2jBiIA==";switch(this.stats={str:5,agi:9,"int":5,cha:9,phys:0,magi:0,maxHP:10},this.color="#58d854",this.purseStr="1d10",this.lootChance=15,this.common=["Food","Food Rotten"],this.uncommon=["Potion Health","Potion Regen"],t){case"Sleeper":this.item1=new Claws("Sleeper"),this.item2=new Vial("Opiates"),this.aiType="switch",this.switchTrigger=4,this.color="#881400",this.spriteCompressed=i,this.displayName="eastern blue-tongued shingleback",this.shortName="Sleeper Snek",this.stats.agi=11,this.stats.maxHP=14,this.rare=["Vial Opiates","Food Spinach","Ring Alert"];break;case"Big":this.spriteCompressed=s,this.displayName="distressingly large Snek",this.shortName="Really Big Snek",this.stats.str=9,this.stats.agi=12,this.stats.cha=11,this.stats.maxHP=18,this.rare=["Vial Opiates","Food Spinach","Ring Alert"];break;case"Small":default:this.item1=new Claws("Venom"),this.spriteCompressed=e,this.displayName="Snek",this.rare=["Food Spinach"]}}function Were(t){this.validTypes=["Wolf","Goat","Hellbeast"],t=plinko(t,this.validTypes),this.stats={str:12,agi:7,"int":5,cha:3,phys:1,magi:0,maxHP:20},this.purseStr="1d20",this.lootChance=19,this.common=["Food","Food Rotten","Buckler"],this.uncommon=["Potion Health","Cloth Rags","Ring Wood"],this.rare=["Vial Steroids","Food Spinach"];var e="IwNgHgLAHAPgDAxTktW9Lhyxhx8HoHH6YkmrmFlU5JbnZ1N7Xb2LGv11fuecKaWsJyFSmQd0kDhyZh3m5lK1WvUbNmhisaiqNEYaHzaC9ownS+/PD1JWWTLszEHKbnZSmPFd37Z23koIQA==",s="IwNgHgLAHAPgDAxTktWpx0M8TWdaK7F6onkrlVlW422lFzV1F4lOfPHaOves+bHumqj2/Mm0JC0jZnMqFlK1WvUbRM7tvlyK+2pQaThY5Cb04KkwSIVcB1jBJGzzNXnozT8Pxf5KFpohqkA=";switch(t){case"Wolf":this.spriteCompressed=e,this.displayName="Werewolf",this.color="#ac7c00",this.stats.phys=0,this.item1=new Claws,this.garment=new Cloth("Rags");break;case"Goat":this.stats.maxHP=22,this.stats.str=9,this.spriteCompressed=s,this.displayName="Weregoat",this.color="#d8d8d8";break;case"Hellbeast":this.stats.maxHP=25,this.stats.str=14,this.stats["int"]=8,this.stats.agi=8,this.stats.magi=1,this.spriteCompressed=s,this.displayName="loathsome, hellish beast",this.shortName="Hellbeast",this.color="#7c7c7c",this.rare=["Sword Fire","Bomb Fire","Ring Fire","Buckler Ruby"]}}function Mage(t){this.inventory=[],this.stats={str:5,agi:8,"int":12,cha:8,phys:0,magi:1,maxHP:12},this.item1=new Staff("Thunder"),this.item2=new Potion("Health"),this.garment=new Cloth("Robes"),this.spriteCompressed="IwNgHgLAHAPgDAxTktW9HgeV7dgEF75K4oEBMuwV5hRJd9WZiLzjpCh3DbCFQfy7da3NJQatSVMdLY0e8/MxapVPHBr7Fde/QcNGJe5UymY2YrdeWrx5peRUacvMvNyCKw4Yo/q/r4yisEKVBZaHJwK9tLafEA==",this.displayName="Wiz",this.color="#0058f8",this.aiType="switch",this.switchTrigger=5,this.purseStr="2d20",this.lootChance=15,this.common=["Ring","Potion Regen","Bow"],this.uncommon=["Potion Health","Bomb"],this.rare=["Sword Fire","Plate Silver","Buckler Ruby"]}function Item(){this.owner="",this.noDamage=!1,this.unique=!1,this.buffs=[],this.immunities=[],this.stats={},this.resists={}}function Buff(t,e){switch(this.selfTargeted=!0,this.itemType="Buff",this.cureChance=3,this.natural=0,this.type="physical",this.targetStat="HP",this.owner=e,this.buffArr=[],this.killStr="from inexplicable causes",this.attackVal=function(){return 0},t){case"Smite":this.killStr="by the hand of the divine";break;case"Explode":this.killStr="in an explosion";break;case"Aflame":this.killStr="in a conflagration",this.cureChance=7,this.attackVal=function(){return roll("1d3")+Math.ceil(roll("1d5")*this.owner.stats.maxHP/100)},this.attackType="fire",this.sprite="flame",this.color="rgba(248,56,0,0.5)",this.verbs=["burn","roast"];break;case"Poisoned":this.killStr="of internal injuries",this.cureChance=5,this.attackVal=function(){return roll("1d3")},this.attackType="poison",this.sprite="bubble",this.color="#d800cc",this.verbs=["waste","wither"];break;case"Regenerating":this.cureChance=4,this.attackVal=function(){var t=Math.ceil(this.owner.stats.maxHP/12);return-1*roll(t+"d3")},this.attackType="white",this.sprite="poof",this.color="#f8d878",this.verbs=["heal","regenerate"];break;case"Juiced":this.cureChance=13,this.attackVal=function(){return-1},this.attackType="poison",this.targetStat="str",this.sprite="bubble",this.color="#f83800",this.verbs=["gain","rage"];break;case"Sedated":this.cureChance=8,this.attackVal=function(){return roll("1d2")-1},this.attackType="poison",this.targetStat="agi",this.sprite="bubble",this.color="#00e8d8",this.verbs=["doze off","zonk out"];break;case"Paralyzed":this.noDamage=!0,this.cureChance=15,this.sprite="chaos",this.color="#ffff00",this.verbs=["freeze up","are immobilized"],this.uniqueStr="momentarily";break;case"Smokey":this.noDamage=!0,this.cureChance=4,this.sprite="cloud",this.color="rgba(152,120,248,0.8",this.verbs=["are"],this.uniqueStr="enshrouded in smoke"}}function Weapon(){this.selfTargeted=!1,this.natural=1,this.buffArr=[],this.userTraits=[],this.uses=!0,this.flammable=!1,this.ranged=!1,this.targetStat="HP",this.attackType="physical",this.itemType="Weapon"}function Punch(){this.uses=!0,this.sprite="poof",this.attackType="physical",this.color="white",this.displayName="nothing but the essentials",this.shortName="Bare Hands",this.verbs=["punch","smack","hit","wallop","slap"],this.attackVal=function(){var t=this.owner.stats.str,e=this.owner.stats.agi;return roll(Math.floor((t+e)/8)+"d3")}}function Sword(t){this.validTypes=["Iron","Cursed","Fire","Wood"],t=plinko(t,this.validTypes),this.sprite="slash1",this.attackType="physical",this.verbs=["slash","strike","stab","lance","wound","cut"];var e="IwNgHqA+AMt/DFOS18BMw20+7v9g9liDUijtpLsss17pjlgg";switch(this.smallSprite=e,this.userTraits=["STR"],t){case"Iron":this.uses=30,this.breakVerb="breaks on impact",this.displayName="a modest but functional iron blade",this.shortName="Iron Sword",this.color="#008888",this.attackVal=function(){var t=Math.round(this.owner.stats.str/4*1.5);return roll(t+"d3")-2};break;case"Cursed":this.uses=30,this.breakVerb="explodes with a loud noise",this.displayName="a dark, sinister looking weapon",this.shortName="Cursed Sword",this.color="#4428bc",this.attackType="shadow",this.resists={light:1.25},this.buffs=["Paralyzed"],this.immunities=["Regenerating"],this.attackVal=function(){var t=Math.round(this.owner.stats.str/4*1.5);return roll(t+"d3")-2};break;case"Fire":case"Flame":this.uses=25,this.breakVerb="glows red-hot, shatters,",this.displayName="a shining red sword that smells of sulfur",this.shortName="Flame Sword",this.color="#f87858",this.attackType="fire",this.buffArr=["Aflame",8],this.attackVal=function(){var t=Math.round(this.owner.stats.str/4*1.5);return roll(t+"d3")-1};break;case"Wood":default:this.flammable=!0,this.breakVerb="splinters into bits",this.uses=20,this.displayName="a wooden sword meant for practice",this.shortName="Wooden Sword",this.color="#f8b800",this.attackVal=function(){var t=Math.round(this.owner.stats.str/4);return roll(t+"d3")}}}function Buckler(t){this.validTypes=["Iron","Mirror","Ruby","Wood"],t=plinko(t,this.validTypes),this.sprite="kapow",this.attackType="physical",this.verbs=["bash","strike","slam","bludgeon","ram"];var e="IwNgHqA+AMt/DFObYaWuAJh+p2s0Dh9CjsSELy1CqzqL6bbL5HXSHdlbc3eeaEA=";switch(this.smallSprite=e,this.userTraits=["STR"],this.stats={block:1},t){case"Iron":this.uses=30,this.breakVerb="cracks into two",this.displayName="a small, battered metal shield",this.shortName="Iron Buckler",this.color="#008888",this.attackVal=function(){return rollHits(this.owner.stats.str+"d5",5)};break;case"Mirror":this.uses=30,this.breakVerb="splits with a thunderous crack",this.displayName="a small, polished, and gleaming shield",this.shortName="Mirrored Buckler",this.color="#a4e4fc",this.attackType="light",this.resists={shadow:.8},this.immunities=["Paralyzed"],this.attackVal=function(){return rollHits(this.owner.stats.str+"d6",6)};break;case"Ruby":case"Fire":case"Flame":this.uses=25,this.breakVerb="glows red-hot, shatters,",this.displayName="a small shield made of a deep crimson crystal",this.shortName="Ruby Buckler",this.color="#881400",this.attackType="fire",this.resists={fire:.75},this.attackVal=function(){return rollHits(this.owner.stats.str+"d5",5)};break;case"Wood":default:this.flammable=!0,this.breakVerb="splinters into bits",this.uses=20,this.displayName="a small, disposable wooden shield",this.shortName="Wooden Buckler",this.color="#f8b800",this.attackVal=function(){return rollHits(this.owner.stats.str+"d8",8)}}}function Axe(t){this.sprite="slash1",this.attackType="physical",this.verbs=["strike","hit","chop","hack","cleave"],this.ranged=!0;var e="IwNgHqA+AMt/DFOS1xWOOjsvbQEx4ErAnRmnnTWa1U4UFA==",s="";switch(t){case"Brass":default:this.smallSprite=e,this.uses=10,this.breakVerb="is bent beyond recognition",this.displayName="an axe made of polished brass, prettier than it is functional",this.shortName="Brass Axe",this.color="#f8d878",this.userTraits=["STR"],this.attackVal=function(){var t=this.owner.stats.str;return Math.ceil(t/roll("1d5"))}}}function Bow(t){this.validTypes=["Wood","Poison"],t=plinko(t,this.validTypes),this.sprite="star",this.attackType="physical",this.verbs=["strike","hit","bullseye","arrow","snipe"],this.ranged=!0;var e="IwNgHqA+AMt/DFOS11gYyrsBM359lhDUS8y4iDpqC7sHsg==",s="";switch(t){case"Poison":this.smallSprite=e,this.flammable=!0,this.uses=20,this.attackType="poison",this.breakVerb="is bent, arrowless",this.displayName="a oily green bow whose arrows are laced with a toxic venom",this.shortName="Poison Bow",this.color="#005800",this.buffArr=["Poisoned",3],this.resists={poison:.75},this.userTraits=["AGI"],this.attackVal=function(){var t=this.owner.stats.agi;return rollHits(t+"d5",5)};break;case"Wood":default:this.smallSprite=e,this.flammable=!0,this.uses=20,this.breakVerb="breaks with a 'sproing'",this.displayName="a simple wooden bow, used by hunters",this.shortName="Wooden Bow",this.color="#f8b800",this.userTraits=["AGI"],this.attackVal=function(){var t=this.owner.stats.agi;return rollHits(t+"d4",4)}}}function Staff(t){this.validTypes=["Thunder","Wood"],t=plinko(t,this.validTypes),this.sprite="kapow",this.attackType="physical",this.verbs=["strike","bludgeon","bash","thwack","smack"];var e="IwNgHqA+AMt/DFOgJmYlx309uu9UtCC9Ttz1LlqlaNiysg==",s="IwNgHqA+AMt/DFOcgTMF9itZ26M91cjs9YzzCryLbpq9HNmVCg==";switch(t){case"Lightning":case"Thunder":this.ranged=!0,this.smallSprite=s,this.uses=25,this.breakVerb="splits down the middle",this.displayName="a staff enchanted with electricity",this.shortName="Thunder Staff",this.sprite="bolt",this.attackType="lightning",this.targetStat="HP",this.color="#b8f8d8",this.userTraits=["INT"],this.verbs=["blast","electrocute","zap","smite"],this.attackVal=function(){return Math.floor(1.5*rollHits(this.owner.stats["int"]+"d3",3))};break;case"Wood":default:this.smallSprite=e,this.flammable=!0,this.uses=20,this.breakVerb="snaps like a twig",this.displayName="a solid, wooden staff",this.shortName="Wooden Staff",this.color="#f8b800",this.userTraits=["STR","AGI"],this.stats={block:1},this.attackVal=function(){var t=this.owner.stats.str,e=this.owner.stats.agi;return rollHits(t+e+"d5",5)}}}function Claws(t){switch(this.validTypes=["Venom","Sleeper","Bone"],t=plinko(t,this.validTypes),this.sprite="claws",this.attackType="physical",this.targetStat="HP",this.verbs=["maul","savage","lacerate","wound","lunge at"],this.smallSprite="IwNgHqA+AMt/DFKcATMxaMK/XPgd0VC59tphSLYqb66bGniX7L0g",t){case"Poison":case"Venom":this.uses=10,this.breakVerb="snaps with a sickening crunch",this.displayName="a pair of fangs with the venom sac still attached",this.shortName="Venom Fang",this.color="#00b800",this.userTraits=["STR","AGI"],this.attackType="poison",this.buffArr=["Poisoned",6],this.attackVal=function(){var t=this.owner.stats.str,e=this.owner.stats.agi;return roll(Math.ceil((t+e)/12)+"d4")};break;case"Sleeper":this.uses=10,this.breakVerb="is hollowed out, broken",this.displayName="a pair of needle-like fangs dripping with noxious poison",this.shortName="Sleeper Fang",this.color="#00e8d8",this.userTraits=["CHA","AGI"],this.attackType="poison",this.buffArr=["Paralyzed",4],this.attackVal=function(){var t=this.owner.stats.cha,e=this.owner.stats.agi;return roll(Math.ceil((t+e)/12)+"d4")};break;case"Bone":default:this.uses=10,this.breakVerb="is worn to stumps",this.displayName="a set of sharp bone claws",this.shortName="Bone Claw",this.color="#f0d0b0",this.userTraits=["STR","AGI"],this.attackVal=function(){var t=this.owner.stats.str,e=this.owner.stats.agi;return roll(Math.ceil((t+e)/8)+"d4")}}}function Hose(t){switch(this.validTypes=["Fire","Acid"],t=plinko(t,this.validTypes),this.sprite="splat",this.attackType="physical",this.verbs=["splash","douse"],this.smallSprite="IwNgHqA+AMt/DFOQ4wBMLZp8ZvM1F1c9oj5STZrKSMLp7sH7H1Ny0PTECCk/boP6d8HDnCA=",t){case"Flame":case"Fire":this.uses=15,this.breakVerb="is empty, starting to smell,",this.displayName="a glowing bladder of sorts, hot to the touch",this.shortName="Lava Sac",this.attackType="fire",this.targetStat="HP",this.color="rgba(248,56,0,0.5)",this.verbs.push("ignite","torch"),
this.buffArr=["Aflame",3],this.attackVal=function(){return roll("1d3")};break;case"Acid":default:this.uses=30,this.breakVerb="melts into a puddle of goo",this.displayName="a Box Jelly's acid generating organ: pretty useless as a weapon",this.shortName="Acid Bladder",this.attackType="acid",this.targetStat="maxHP",this.color="rgba(88,216,84,0.5)",this.verbs.push("slime","spatter"),this.attackVal=function(){return roll("1d2")}}}function Consumable(){this.selfTargeted=!0,this.natural=0,this.buffArr=[],this.uses=1,this.hurts=!1,this.targetStat="HP",this.amountDmg="a random amount of",this.attackVal=function(){return 0},this.itemType="Consumable"}function Bomb(t){this.validTypes=["Smoke","Fire"],t=plinko(t,this.validTypes),this.unique=!0,this.sprite="cloud",this.verbs=["detonate","toss","light"];var e="IwNgHqA+AMt/DFNgJmfFmnB8abtdcCEiy9TzdKrq5aj5gVaWmWq32OdMLvMgrpSE500RrCA=";switch(this.smallSprite=e,this.breakVerb="is empty",t){case"Smoke":this.uses=5,this.displayName="small explosives that do no damage but create a distracting cloud of smoke",this.shortName="Sack of Smoke Bombs",this.uniqueStr="a smoke bomb",this.color="#6844fc",this.buffArr=["Smokey",1],this.attackVal=function(){return this.owner.effectController.displayDamage("cloud","rgba(152,120,248,0.8"),this.owner.wiggle("hit",250),0};break;case"Flame":case"Fire":default:this.smallSprite="IwNgHqA+AMt/DFwExKcVxhvl5zsd4Ci4tTYNCc9q0MSiHH7am2aP26m4g===",this.uses=5,this.displayName="crude, unpredictable incendiary devices made from rubbish",this.shortName="Sack of Fire Bombs",this.uniqueStr="a fire bomb",this.attackType="fire",this.targetStat="HP",this.color="#006800",this.attackVal=function(){this.owner.getEnemy().addBuff("Aflame"),this.owner.getEnemy().explode(roll("2d5"),"fire"),this.owner.getEnemy().effectController.displayDamage("flame","rgba(248,56,0,0.5)"),this.owner.getEnemy().wiggle("hit",250);var t=4===roll("1d4")?!0:!1;return t&&(this.owner.addBuff("Aflame"),this.owner.explode(roll("2d5"),"fire"),this.owner.effectController.displayDamage("flame","rgba(248,56,0,0.5)"),this.owner.wiggle("hit",250)),0}}}function Potion(t){this.validTypes=["Health","Regen"],t=plinko(t,this.validTypes),this.uses=1,this.sprite="poof",this.breakVerb="is empty",this.shortName="Potion of ";var e="IwNgHqA+AMt/DFOS5x0ddYAmbXs9gDd9VTZi094qFcdGmc65cMMXF2P2kHmrer2hA===";switch(this.smallSprite=e,t){case"Regen":this.attackType="physical",this.color="#f8d878",this.amountDmg="1-6",this.shortName+="Regen",this.displayName="a fizzy yellowish potion that smells like chalk",this.buffArr=["Regenerating",1],this.verbs=["regenerate"],this.attackVal=function(){return-1*roll("1d6")};break;default:case"Health":this.attackType="physical",this.color="#58f898",this.amountDmg="your entire",this.shortName+="Health",this.displayName="a brilliant green potion, slightly warm to the touch",this.verbs=["heal"],this.attackVal=function(){return-1*this.owner.stats.maxHP}}}function Vial(t){switch(this.validTypes=["Steroids","Opiates"],t=plinko(t,this.validTypes),this.uses=1,this.sprite="poof",this.breakVerb="is used-up",this.shortName="Vial of",this.smallSprite="IwNgHqA+AMt/DHQEyuU+wvY3Yt9cDijpDCjzSz0LdhU6MHkmkW3EPrvTe+KQA===",t){case"Steroids":this.hurts=!0,this.displayName="a small ampule of dangerous performance-enhancing drugs",this.attackType="poison",this.targetStat="cha",this.amountDmg="1-5",this.color="#f83800",this.shortName+=" Steroids",this.buffArr=["Juiced",1],this.verbs=["inject"],this.attackVal=function(){return roll("1d5")};break;default:case"Opiates":this.hurts=!1,this.displayName="a tiny vial of powerful pain-killers",this.attackType="poison",this.targetStat="HP",this.amountDmg="your entire",this.color="#00e8d8",this.shortName+=" Opiates",this.buffArr=["Sedated",2],this.verbs=["medicate"],this.attackVal=function(){return-1*this.owner.stats.maxHP}}}function Food(t){this.validTypes=["Spinach","Rotten","Meat"],t=plinko(t,this.validTypes),this.uses=1,this.sprite="poof",this.breakVerb="is consumed",this.verbs=["eat","smash","chow down","consume"];var e="IwNgHqA+AMt/DFOY4aWzVgTCrO9htsjdki1jDKrzTbyG8yNojW32Ppsg",s="IwNgHqA+AMt/DHWC4S4oEzcypwdDdFVDUTtUDiFqib5Sdzaq2S2qPO9bKm0feg0Z1cg9F2hA";switch(t){case"Spinach":this.smallSprite=s,this.displayName="a tin of creamed spinach: unpleasant but hearty.",this.attackType="physical",this.targetStat="maxHP",this.color="#00a844",this.amountDmg="2-10",this.shortName="Can of Spinach",this.buffArr=["Juiced",5],this.attackVal=function(){return-1*roll("2d5")};break;case"Rotten":this.smallSprite=e,this.displayName="a hunk of raw, slightly decomposed meat",this.attackType="physical",this.targetStat="HP",this.color="#b8f8b8",this.amountDmg="12-20",this.shortName="Questionable Meat",this.buffArr=["Poisoned",3],this.attackVal=function(){return-1*(10+roll("2d5"))};break;case"Meat":default:this.smallSprite=e,this.displayName="a savory grilled drumstick of some unknown animal",this.attackType="physical",this.targetStat="HP",this.color="#e45c10",this.amountDmg=20,this.shortName="Tasty Meat",this.attackVal=function(){return-20}}}function Wearable(){this.selfTargeted=!1,this.uses=!0,this.flammable=!1,this.ranged=!1,this.stats={},this.resists={},this.buffs=[],this.immunities=[]}function Armor(){this.itemType="Armor"}function Nude(){this.uses=!0,this.smallSprite="",this.color="white",this.displayName="just as god made ya'",this.shortName="Birthday Suit",this.stats={cha:1}}function Cloth(t){this.validTypes=["Robes","Shirt","Rags"],t=plinko(t,this.validTypes),this.flammable=!0,this.breakVerb="is shredded beyond recognition";var e="IwNgHqA+AMt/DFOSlxbrcATMHek89tcjEiKz4DjToC4bL7MFLXz2O3nULYgA",s="IwNgHqA+AMt/DG2MJjgCYOrcrWddNtdoVtMUkVyKqEbGaHUnXCz3HPqmi2O8AYOTCRnNqW7QgA==";switch(this.stats={phys:1},this.smallSprite=e,t){case"Robes":this.smallSprite=s,this.stats.magi=1,this.color="#0000bc",this.uses=30,this.displayName="a garment made for apprentice spellcasters",this.shortName="Magician's Robe";break;case"Shirt":this.color="#a4e4fc",this.uses=30,this.displayName="a decently sewn linen garment",this.shortName="Linen Tunic";break;default:case"Rags":this.color="#503000",this.uses=20,this.displayName="a few scraps of burlap and linen",this.shortName="Sackcloth Tunic",this.resists={fire:1.25},this.immunities=["Regenerating"]}}function Plate(t){this.validTypes=["Silver","Brass"],t=plinko(t,this.validTypes);var e="IwNgHqA+AMt/DFOSpxro1xxcCZ9dM5Dg8Czd5zKiDz4qL8NjWMKD2cyKVS+yfIP5FYQA";switch(this.breakVerb="falls dented and broken to the ground",this.stats={phys:2},this.smallSprite=e,t){case"Silver":this.color="#d8d8d8",this.stats={phys:1,block:2},this.uses=25,this.immunities=["Aflame"],this.resists={fire:.75,lightning:.75},this.displayName="thin, reflective armor polished with flame-resistant oils",this.shortName="Silver Armor";break;default:case"Brass":this.color="#f8d878",this.uses=15,this.stats={block:2},this.displayName="shiny, brass plates formed into a decorative, muscular, but somewhat flimsy chestplate",this.shortName="Brass Platemail"}}function Accessory(){this.itemType="Accessory"}function Nothing(){this.uses=!0,this.smallSprite="",this.color="white",this.displayName="a whole lot of it",this.shortName="Nothing",this.stats={}}function Ring(t){this.validTypes=["Emerald","Fire","Wood","Brass"],t=plinko(t,this.validTypes);var e="IwNgHqA+AMt/DFOS1x2uugTLjT9ZthlCiSF0K5jEdrpbLimtSWqH56rNfYgA";switch(this.smallSprite=e,t){case"Alert":case"Emerald":this.stats={agi:1},this.immunities=["Paralyzed","Sedated"],this.color="#00b800",this.uses=20,this.breakVerb="melts into thin air",this.displayName="a brilliant green ring that tingles on your finger",this.shortName="Ring of Alertness";break;case"Flame":case"Fire":this.resists={fire:.8},this.buffs=["Aflame"],this.color="#881400",this.uses=20,this.breakVerb="crumbles into soot",this.displayName="a ring encircled in dim flames, and scorching to the touch",this.shortName="Flaming Ring";break;case"Brass":this.stats={str:1},this.color="#f8d878",this.uses=20,this.breakVerb="is tarnished, worn, and dull",this.displayName="a shiny, brass ring: not very useful, but wearing it gives you a sense of confidence",this.shortName="Brass Ring";break;default:case"Wood":this.flammable=!0,this.stats={maxHP:5},this.color="#f8b800",this.uses=30,this.breakVerb="snaps in half",this.displayName="a solid, oaken ring: not very useful, but wearing it gives you a feeling of fortitude",this.shortName="Wood Ring"}}function Effect(){this.sprites={kapow:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJBAjKZahRjVSnQ4hOi/WmTZ/N+5ZwMGM+yLl2oQyESZJG0hHKdMnC5STtN6ilylWoY696jbpXisqnCa3HTR/ccGLdNhzx7nRMmZbcWhTn54vCG+QdTojGyo0eGRmGFxHAhAA==",slash1:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJpZaAjOdZTXUlfU40zRS5h65e9l9ynb9BwkXSF9RyXtQlYpAhDM6KMC1bnUa+20oyA",blast:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJeAjGfBaTUpRQ4/bTU25S2h41Yk3zxLV07DggaoJRNl2FSq8uovLcxStfOXrCwhSl3iNa5AZUD9x2AdNLicywqNitAh9hmT7Tt4OlvDHgGe/iyqcq7Wvpw6oi7ROPSxVvGk9rBAA==",claws:"GwFgHgTCA+AM8MU5LVvRzXs93/BGExhpeAjORGTdpdQsQ7S/FQva12x+4yd0LkOzToLLDYlNn3GlJ0qcznypCyStrTFmmto1pqDZbo4yisY6bQ6bUntZQHUwhY9Vv3BVw9RH4DEA",poof:"GwFgHgTCA+AM8MU5LVvRzXs93/mAjASasaRYuUWdtafVTZbI0mwvR5y/Nz8n69B7YWNF9xU6TNlzWHQuSVEVWIfM1bN1DdvSM9+gxkXGmaflxPnWtU7aOSR6809stqQA",splat:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxhAjCduRdWuaVTQw/M/vfTS8h8ex62Tqx2JPjwpi+EkV1GSEAwbMHzqkxZRbq523qo1Z1MlVOn7ewqgc26LnREbvLhoy1ev3cQ7vCA=",bolt:"GwFgHgTCA+AM8MU58CMKOZervM70MQKKJNL3Iqyuo1rqXQcYVRcZw87Vd2+oC+vYU1GVxbSf0lDRcmdPrtxC1gTXYlW6c01klJFYZPJ99WOYtNjwrtrGW7UhyLeDH2qzrTfrr93kAl1MAv2wgA==",flame:"GwFgHgTCA+AM8MU5LVvRzXs93/BaAjIZiaauRZdckVbUvYwsy0w7W7Jyr06358y9ckMTdhPUVkl8Zc+emajxEtatU14i9ZqFVdO+hH1Kt81ad0qZl6xY5m6mh5c0uTzvaLdPfjsZWdoJEEOFecvoODAFhEVGugSbhqX5B1qkh0vFp1nqZCbG5eZIpefmCFQnq1ZWsdbwlaU2NdG0c1a0Vis01TF385fWdWQYlRsNGQWozItOh5EA",bubble:"GwFgHgTCA+AM8MU5FlvRtrM9tvuh6++RZ5FyAjFbiZTeo/PdbYfs4V0jwZZj5sB3ERiE52Y6tNmwpcpouUrVvZeyA===",rain:"GwFgHgTCA+EAwMU5LkEYn1dncOfVzixXwRITOwqStSpuOzsMUccqIZQ6LwOS8+3QZz6IRAllRal6rMblmzaw3BxWqcvTRPXyu+gwvHGtp8gpJ1dTc9ZPVtOW0KG27qd3p7PmPj3EyDEC1MVDRfwiBM0cvCx8jBP4iIRc+NPTHTNiUtiS4ugcYwsi8/NzNIv84xIqgrPqw3KxpZKk5BOVO027apQLfGqc/YfjRnvGnIA=",shield:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJpZ8AjBWlbXbaneQlTROx59ShRK87H48+9Kn0YiBg7sNFiZSXkPLLFI0eNkKyqxErmbk+qbpbr6htaeLXB5upb2SBtuxu1PXBV/ocezXvhevkoYgUH+VqFhkTaxTo6M8YTh0thCQA=",cloud:"GwFgHgTCA+AM8MU5LVvRzXs93hAjAfpkSUkcbJVedWfQ+TVU8zfGxVxRB6T0QE+lAfyQQRLdC1qJJsuZ2KKI3KTTVCVsrYWGrtBliP3HNTShqKnl5q5ZuLRja9NfOGDz/M9s37vAB4rDBLtRhwoSReva60X6xfo7JZn5pPvQKTprK2XFaNlLWhcLFJnYaktWl9jWSlZr1jVbNeVXVtEVNCvr5Zb3tPXxmNYGunSGt/XLT1twDgSYzC5Phy/Or2cgbghO2RkUHyA0YRdinMmV0Z0o3+vc74Y+Md/d7N0xAA==",star:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJpREZlWFaNVpAjKk/ZS4u62Q+58nV2w9hmFgNTi2I0XzQ9Ww2SnlYVVRUsQ1NKSUV47+g9LMPHVzc4T0IbV4hSA===",chaos:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxqAjOeSVepYrdQ7KfBK6/MyhfY2pxEgFNknBKN5dYQii2F0W7OWR4Fm0sbNH8E6yR2Jq56gVqn6z4jWaX5DhkxY0O7kgQ8Ivrn4bvdJtNniGStqm1l5kVkTBMo7yUoqW/iqqsoi68VESemyJyrHZfJYphR7c8EA",cresent:"GwFgHgTCA+AM8MU5LVvRzXs93/BhRxJpZ5FmAjDVehJQbc3cg43s4jcqxzjzZJ2/bLVR9Yk0RkEoRUkgqbTEC1fmWcNKOYR0DDxA2JPcdW+CL37LuvVTtXx5R6ZoMgA="},this.color="yellow",this.associatedCharacter=""}function loadButtons(t){for(var e=t.querySelectorAll(".button"),s=0;s<e.length;s+=1)e[s].addEventListener("click",function(t){return function(){var e=t.getAttribute("click-data");currentGame[firstWord(e)](secondWord(e))}}(e[s]))}var __nativeST__=window.setTimeout;window.setTimeout=function(t,e){var s=this,i=Array.prototype.slice.call(arguments,2);return __nativeST__(t instanceof Function?function(){t.apply(s,i)}:t,e)};var intervalRelay="",currentGame=new Game,interfaceElement=document.getElementById("interface"),inventoryCanvases=[document.getElementById("invSprite1").getContext("2d"),document.getElementById("invSprite2").getContext("2d"),document.getElementById("invSprite3").getContext("2d"),document.getElementById("invSprite4").getContext("2d"),document.getElementById("invSprite5").getContext("2d"),document.getElementById("invSprite6").getContext("2d"),document.getElementById("invSprite7").getContext("2d"),document.getElementById("invSprite8").getContext("2d")];Displayable.prototype.constructor=Displayable,Displayable.prototype.draw=function(t,e){var s=LZString.decompressFromBase64(e),i=s.slice(s.indexOf("|")+1),a=s.slice(0,s.indexOf("x")),r=s.slice(s.indexOf("x")+1,s.indexOf("|"));t.clearRect(0,0,a,r),t.fillStyle=this.color;for(var o=0;o<i.length;o+=1){var n=Math.floor(o/a);1==i.slice(o,o+1)?(t.fillStyle=this.color,t.fillRect(o-n*a,n,1,1)):2==i.slice(o,o+1)&&(t.fillStyle=halfBlack(this.color),t.fillRect(o-n*a,n,1,1))}},Location.prototype=new Displayable,Location.prototype.constructor=Location,Character.prototype=new Displayable,Character.prototype.constructor=Character,Character.prototype.updateStatus=function(){this.stats.HP<1?this.stats.HP=0:this.stats.HP>this.stats.maxHP&&(this.stats.HP=this.stats.maxHP),this.displayElement.hpText.innerHTML=this.stats.HP+"/"+this.stats.maxHP;var t=Math.floor(this.stats.HP/this.stats.maxHP*100);this.displayElement.hpBar.style.width=t+"%",this.displayElement.hpBar.className="hp-bar hp-"+10*Math.round(t/10),"Hero"===this.constructor.name&&this.drawInventory(),0===this.stats.HP&&this.die()},Character.prototype.addClass=function(t){this.div.classList.add(t)},Character.prototype.wiggle=function(t,e){this.div.classList.add(t);var s=this;setTimeout(function(){s.div.classList.remove(t)},e)},Character.prototype.switchWeapon=function(t,e){("Weapon"===t.itemType||"Consumable"===t.itemType)&&("undefined"==typeof t&&(t=new Punch),this.remove(this["hand"+e]),this.wear(t),this["hand"+e]=t,"Hero"===this.constructor.name&&(document.getElementById("equip"+e).innerHTML=shorten(t.shortName,17)))},Character.prototype.equip1=function(t){this.switchWeapon(t,1)},Character.prototype.equip2=function(t){this.switchWeapon(t,2)},Character.prototype.wear=function(t){var e=[this.armor,this.accessory,this.hand1,this.hand2];if(!e.includes(t)&&"undefined"!=typeof t.itemType){if(t.owner=this,"Armor"===t.itemType?this.armor=t:"Accessory"===t.itemType&&(this.accessory=t),t.buffs!==[]){t.uses-1;for(var s=t.buffs.length-1;s>=0;s--)this.addBuff(t.buffs[s])}if(t.immunities!==[])for(var i=t.immunities.length-1;i>=0;i--)this.immunities.includes(t.immunities[i])||this.immunities.push(t.immunities[i]);for(var a in t.stats)this.stats[a]+=t.stats[a];this.calcResists(),this.updateStatus()}},Character.prototype.remove=function(t){var e=[this.armor,this.accessory,this.hand1,this.hand2];if(!e.includes(t)&&"undefined"!=typeof t.itemType){this.armor===t?this.armor={}:this.accessory===t&&(this.accessory={});for(var s in t.stats)this.stats[s]-=t.stats[s];if(t.immunities!==[])for(var i=t.immunities.length-1;i>=0;i--)if(!this.naturalImmunities.includes(t.immunities[i])){var a=this.immunities.indexOf(t.immunities[i]);this.immunities.splice(a,1)}this.calcResists(),this.updateStatus()}},Character.prototype.calcResists=function(){this.resists={};for(var t=[this.armor],e=[this.naturalResists],s=t.length-1;s>=0;s--)t[s].resists!=={}&&e.push(t[s].resists);for(var i=e.length-1;i>=0;i--)for(var a in e[i])this.resists.hasOwnProperty(a)?this.resists[a]=this.resists[a]<e[i][a]?this.resists[a]:e[i][a]:this.resists[a]=e[i][a]},Character.prototype.getEnemy=function(){return"Hero"===this.constructor.name?currentGame.currentMonster:currentGame.playerHero},Character.prototype.defense=function(t){switch(t){case"white":case"black":return this.stats.magi;case"lightning":case"fire":return this.burnItems(),Math.floor((this.stats.magi+this.stats.phys)/2);case"poison":return 0;case"physical":default:return this.stats.phys}},Character.prototype.burnItems=function(){for(var t=[this.hand1,this.hand2,this.armor,this.accessory],e=t.length-1;e>=0;e--)"undefined"!=typeof t[e]&&t[e].flammable===!0&&(t[e].uses-=roll("2d3"),t[e].uses=t[e].uses>0?t[e].uses:1,t[e].breakVerb="is charred to a crisp")},Character.prototype.smite=function(t){this.stats.HP-=t,this.lastHitBy=new Buff("Smite",this).attackObj(),this.updateStatus()},Character.prototype.explode=function(t,e){var s="undefined"!=typeof this.resists[e]?this.resists[e]:1,i=this.defense(),a=0>t-i?0:t-i;this.stats.HP-=Math.ceil(a*s),this.lastHitBy=new Buff("Explode",this).attackObj(),this.updateStatus()},Character.prototype.calcDodge=function(t){if(this.buffs.includes("Sedated")||this.buffs.includes("Paralyzed")||"inanimate"==this.aiType)return!1;var e=roll("1d"+1.25*this.getEnemy().stats.agi),s=0;s+=this.hand1.ranged?1:0,s+=this.hand2.ranged?1:0,s+=this.buffs.includes("Smokey")?5:0,s+=t===!0?2:0,s-=""!==this.offHand&&"undefined"!=typeof this.offHand?2:0;var i=roll("1d"+Math.ceil(this.stats.agi/3))+s,a=i>=e?!0:!1;return a},Character.prototype.calcBlock=function(){if(this.buffs.includes("Sedated")||this.buffs.includes("Paralyzed")||"inanimate"==this.aiType)return!1;var t=roll("1d30"),e=this.stats.block>=t?!0:!1;return e},Character.prototype.dodge=function(){this.wiggle("dodge",500),currentGame.log.add(this.selfStr()+" "+this.conjugate("dodge")+" "+this.getEnemy().possesive()+" attack."),intervalRelay="End turn"},Character.prototype.block=function(){this.effectController.displayDamage("shield","#7c7c7c"),this.wiggle("hit",250),currentGame.log.add(this.selfStr()+" "+this.conjugate("block")+" "+this.getEnemy().possesive()+" attack."),intervalRelay="End turn"},Character.prototype.hit=function(t){intervalRelay="wait";var e=this.defense(t.type),s="undefined"!=typeof this.resists[t.type]?this.resists[t.type]:1;"HP"!==t.targetStat&&(t.natural=0);var i=t.calculated-e<0?0:t.calculated-e,a=Math.ceil((t.natural+i)*s),r=Math.ceil((t.calculated+t.natural)*s),o=0;switch(t.itemType){case"Consumable":o=r;break;case"Weapon":o=a;case"Buff":o=t.calculated<0?r:a,o=t.noDamage===!0?0:o}this.stats[t.targetStat]-=o,t.itemType=t.unique?"Unique":t.itemType,"Unique"!==t.itemType&&(this.effectController.displayDamage(t.sprite,t.color),this.wiggle("hit",250));var n=randomEntry(t.verbs),h="";switch(this.lastHitBy=t,t.itemType){case"Unique":h=firstCap(this.selfStr())+" "+this.conjugate(n)+" "+t.uniqueStr+".";break;case"Consumable":case"Buff":t.calculated<0&&(o=Math.abs(o)),h=firstCap(this.selfStr())+" "+this.conjugate(n)+" for "+o+t.targetStat.toUpperCase()+".",h=t.noDamage===!0?firstCap(this.selfStr())+" "+this.conjugate(n)+" "+t.uniqueStr+".":h;break;case"Weapon":h=firstCap(this.getEnemy().selfStr())+" "+this.getEnemy().conjugate(n)+" "+this.selfStr().toLowerCase()+" for "+o+t.targetStat.toUpperCase()+"."}this.armor.uses!==!0&&this.armor.uses--,currentGame.log.add(h),this.updateStatus();var c=1;if(t.buffArr.length>1){var l=t.buffArr[0],u=t.buffArr[1],d=rollHits("1d"+u,u)>=1;d&&!this.buffs.includes(l)&&this.stats.HP>0&&(this.addBuff(l),c++)}"Buff"!==t.itemType&&setTimeout(function(){intervalRelay="Check equip"},1e3*c)},Character.prototype.selfStr=function(){return"Hero"===this.constructor.name?"You":"The "+this.shortName},Character.prototype.conjugate=function(t){return"Hero"===this.constructor.name?t:thirdPerson(t)},Character.prototype.addBuff=function(t){if(!this.buffs.includes(t)&&!this.immunities.includes(t)){var e=firstCap(this.selfStr())+" "+this.conjugate("are")+" "+t+".";setTimeout(function(){currentGame.log.add(e)},1e3),this.buffs.push(t)}},Character.prototype.removeBuff=function(t){if(this.buffs.includes(t)){var e=this.buffs.indexOf(t);-1!==e&&this.buffs.splice(e,1)}},Character.prototype.runBuffs=function(){var t="Use equip";if(this.buffs.length<1)return void(intervalRelay=t);var e=this.buffs.slice(),s=this,i=0,a=!1,r={},o=!0,n=setInterval(function(){if(!a&&o){r=new Buff(e[i],s).attackObj(),s.hit(r);var h=roll("1d20")<=r.cureChance;h?(s.removeBuff(e[i]),a=!0,setTimeout(function(){o=!0},1e3)):(i++,setTimeout(function(){o=!0},1e3))}else o&&(s.stats.HP>0&&currentGame.log.add(s.selfStr()+" "+s.conjugate("are")+" no longer "+e[i].toLowerCase()+"."),a=!1,i++);i>=e.length&&!a&&o&&(s.stats.HP<=0&&(t="End round"),clearInterval(n),setTimeout(function(){intervalRelay=t},1e3))},750)},Character.prototype.checkEquip=function(t){for(var e=new Nude,s=[this.hand1,this.hand2,this.armor,this.accessory],i=[],a=s.length-1;a>=0;a--)"undefined"!=typeof s[a]&&s[a].checkExhausted()&&i.push(s[a]);switch(t){case"activate1":case"activate2":if(i.length>0){e=randomEntry(i),i.splice(i.indexOf(e),1);for(var r=i.length-1;r>=0;r--)i[r].uses=1}else intervalRelay="End turn";break;case"activateOffhand":e=this.offHand;break;default:return void(intervalRelay="End turn")}e.checkExhausted()?(e.exhaust(),setTimeout(function(){intervalRelay="End turn"},1e3)):intervalRelay="End turn"},Character.prototype.runAway=function(){this.offHand="";var t=this.calcDodge(!0),e="",s="";t?(e="Hero"===this.constructor.name?"manage":"manages",s=firstCap(this.selfStr())+" "+e+" to escape!",currentGame.log.add(s),currentGame.currentMonster.addClass("escaped"),setTimeout(function(){intervalRelay="End round",currentGame.switchMonster()},1e3)):(e="Hero"===this.constructor.name?"try":"tries",s=firstCap(this.selfStr())+" "+e+" to flee, but to no avail...",currentGame.log.add(s),setTimeout(function(){intervalRelay="End turn"},1e3))},Character.prototype.activateOffhand=function(){this.useItem(this.offHand)},Character.prototype.equip1Offhand=function(){this.equip1(this.offHand),currentGame.log.add(firstCap(this.selfStr())+" "+this.conjugate("equip")+" the "+this.offHand.shortName.toLowerCase()+"."),this.offHand="",setTimeout(function(){intervalRelay="Check equip"},1e3)},Character.prototype.equip2Offhand=function(){this.equip2(this.offHand),currentGame.log.add(firstCap(this.selfStr())+" "+this.conjugate("equip")+" the "+this.offHand.shortName.toLowerCase()+"."),this.offHand="",setTimeout(function(){intervalRelay="Check equip"},1e3)},Character.prototype.wearOffhand=function(){"Armor"===this.offHand.itemType?this.switchArmor(this.offHand):"Accessory"===this.offHand.itemType&&this.switchAccessory(this.offHand),currentGame.log.add(firstCap(this.selfStr())+" "+this.conjugate("put on")+" the "+this.offHand.shortName.toLowerCase()+"."),this.offHand="",setTimeout(function(){intervalRelay="Check equip"},1e3)},Character.prototype.removeOffhand=function(){"Armor"===this.offHand.itemType?this.switchArmor():"Accessory"===this.offHand.itemType&&this.switchAccessory(),currentGame.log.add(firstCap(this.selfStr())+" "+this.conjugate("remove")+" the "+this.offHand.shortName.toLowerCase()+"."),this.offHand="",setTimeout(function(){intervalRelay="Check equip"},1e3)},Character.prototype.freeze=function(){this.offHand="",currentGame.log.add(firstCap(this.selfStr())+" "+this.conjugate("are")+" paralyzed and unable to move."),setTimeout(function(){intervalRelay="Check equip"},1e3)},Character.prototype.wait=function(){this.offHand="",currentGame.log.add(firstCap(this.selfStr())+" "+this.conjugate("do")+" nothing."),setTimeout(function(){intervalRelay="Check equip"},1e3)},Character.prototype.activate1=function(){this.offHand="","undefined"==typeof this.hand1&&this.equip1(new Punch),this.useItem(this.hand1)},Character.prototype.activate2=function(){this.offHand="","undefined"==typeof this.hand2&&this.equip2(new Punch),this.useItem(this.hand2)},Character.prototype.useItem=function(t){var e=t.attackObj();e.targetCharacter!==this&&e.targetCharacter.calcDodge()?e.targetCharacter.dodge():e.targetCharacter!==this&&e.targetCharacter.calcBlock()?e.targetCharacter.block():(t.uses!==!0&&t.uses--,e.targetCharacter.hit(e))},Character.prototype.runTurn=function(t){this.accessory.uses!==!0&&this.accessory.uses--;var e="Hero"===this.constructor.name?"Monster turn":"End round";intervalRelay="Check buffs";var s=this,i=setInterval(function(){if("Check buffs"===intervalRelay)intervalRelay="wait",s.runBuffs();else if("Use equip"===intervalRelay)intervalRelay="wait",s.buffs.includes("Sedated")||s.buffs.includes("Paralyzed")?s.freeze():s[t]();else if("Check equip"===intervalRelay)intervalRelay="wait",s.checkEquip(t);else if("End turn"===intervalRelay)intervalRelay="wait",clearInterval(i),intervalRelay=e;else if("End round"===intervalRelay)return void clearInterval(i)},250)},Character.prototype.addToInv=function(t){if(this.inventory.length<8)t.owner=this,this.inventory.push(t),"Hero"===this.constructor.name&&this.updateStatus();else if("Hero"===this.constructor.name){var e=this;setTimeout(function(){e.inventoryFull(t)},600)}},Character.prototype.die=function(){intervalRelay="End round",this.addClass("dead");var t="";switch(this.lastHitBy.itemType){case"Consumable":t=this.selfStr()+" died of self-inflicted wounds.";break;case"Buff":t=this.selfStr()+" died "+this.lastHitBy.killStr+".";break;case"Weapon":if("Hero"===this.constructor.name)t="You were slain by the "+this.getEnemy().shortName+".";else{var e="slayed";e="inanimate"===this.aiType?"destroyed":e,e="Chest"===this.constructor.name?"opened":e,t="You "+e+" the "+this.shortName+"."}}currentGame.log.add(t),"Hero"===this.constructor.name?(currentGame["interface"].pause(),setTimeout(function(){currentGame.log.add("You slayed "+currentGame.playerHero.kills+" monsters and found "+currentGame.playerHero.gold+" gold before perishing.")},2e3)):currentGame.playerHero.stats.HP>0&&(currentGame.playerHero.kills++,currentGame.currentLocation.switchTrigger--,this.loot())},Hero.prototype=new Character,Hero.prototype.constructor=Hero,Hero.prototype.drawInventory=function(){for(var t=7;t>=0;t--)inventoryCanvases[t].clearRect(0,0,16,16);for(var e=this.inventory.length-1;e>=0;e--){var s=inventoryCanvases[e],i=this.inventory[e].smallSprite;this.inventory[e].draw(s,i)}},Hero.prototype.debug=function(){for(var t=this.inventory.length-1;t>=0;t--)this.inventory[t].uses=0;currentGame.log.add("Your items crumble before your eyes!"),this.effectController.displayDamage("cloud","#dddddd"),this.wiggle("hit",250),setTimeout(function(){intervalRelay="End turn"},1e3)},Hero.prototype.possesive=function(){return"your"},Hero.prototype.initialize=function(){this.effectController=new Effect,this.effectController.link(this),this.addToInv(new Sword("Wood")),this.addToInv(new Potion("Health")),this.addToInv(new Cloth("Shirt")),this.equip1(this.inventory[0]),this.equip2(this.inventory[1]),this.wear(this.inventory[2]),this.wear(new Nothing),this.gold=0,this.draw(this.canvas,this.spriteCompressed),this.updateStatus()},Hero.prototype.switchArmor=function(t){"undefined"==typeof t&&(t=new Nude),this.remove(this.armor),this.wear(t)},Hero.prototype.switchAccessory=function(t){"undefined"==typeof t&&(t=new Nothing),this.remove(this.accessory),this.wear(t)},Hero.prototype.receive=function(t,e){currentGame.foundItem=t;var s="You find a "+t.shortName+"!",i=e===!0?"takeLootedItem":"takeFoundItem",a=e===!0?"newMonster":"closeDialog";currentGame.dialog.addButton("Take the "+t.shortName,"router "+i),currentGame.dialog.addButton("Leave it","router "+a),currentGame.dialog.setText(s),currentGame.dialog.open()},Hero.prototype.inventoryFull=function(t){for(var e="You don't have room in your knapsack for the "+t.shortName+"!<br> Would you like to drop something?",s=0;s<=this.inventory.length-1;s++)currentGame.dialog.addButton("Drop your "+this.inventory[s].shortName,"dropItem "+s);currentGame.dialog.addButton("Leave the "+t.shortName+" behind","router closeDialog"),currentGame.dialog.setText(e),currentGame.dialog.open()},Hero.prototype.infoDialog=function(){var t=this.name+"<br>HP: "+this.stats.HP+"/"+this.stats.maxHP+"<br><br>";t+="STR: "+this.stats.str+" | AGI :"+this.stats.agi+"<br>",t+="INT: "+this.stats["int"]+" | CHA :"+this.stats.cha+"<br><br>",t+="Physical Defense: "+this.stats.phys+"<br>Magical Defense: "+this.stats.magi+"<br>",t+="Blocking: "+Math.round(3*this.stats.block)+"% chance<br><br>",this.buffs.length>0&&(t+="Currently: "+this.buffs.join(", ")+"<br><br>"),t+="Right hand: "+this.hand1.shortName+"<br>Left hand: "+this.hand2.shortName+"<br>",t+="Armor: "+this.armor.shortName+"<br>",t+="Accessory: "+this.accessory.shortName+"<br><br>",t+="Kills: "+this.kills+"<br>Gold: "+this.gold,currentGame.dialog.addButton("Back to game","router closeDialog"),currentGame.dialog.setText(t),currentGame.dialog.open()},Monster.prototype=new Character,Monster.prototype.constructor=Monster,Monster.prototype.possesive=function(){return"the "+this.shortName.toLowerCase()+"'s"},Monster.prototype.ai=function(){switch("undefined"==typeof this.aiType&&(this.aiType="simple"),this.aiType){case"mimic":if(this.stats.HP<this.stats.maxHP)return"mimic";case"inanimate":return"wait";case"simple":return"activate1";case"random":return Math.random()>.5?"activate1":"activate2";case"switch":return"undefined"==typeof this.switchTrigger&&(this.switchTrigger=Math.round(this.maxHP/2)),this.stats.HP>=this.switchTrigger?"activate1":"activate2";case"buffer":return"Punch"!==this.hand1.constructor.name?"activate1":"activate2"}},Monster.prototype.announce=function(){var t="";t=currentGame.previousMonsterName===this.displayName?"another ":-1!=="AEIOU".indexOf(this.displayName.slice(0,1))?"an ":"a ";var e="It's "+t+this.displayName.toLowerCase()+"!";currentGame.log.add(e),""===this.shortName&&(this.shortName=this.displayName),this.displayElement.name.innerHTML=this.shortName},Monster.prototype.appear=function(){this.announce(),this.buffs=[],this.stats.block=0,this.immunities=this.naturalImmunities.slice(0),this.inventory=[],"undefined"!=typeof this.item1&&this.addToInv(this.item1),"undefined"!=typeof this.item2&&this.addToInv(this.item2);var t=this.inventory[0]?this.inventory[0]:new Punch,e=this.inventory[1]?this.inventory[1]:new Punch;this.equip1(t),this.equip2(e),"undefined"!=typeof this.garment?(this.wear(this.garment),this.addToInv(this.garment)):this.wear(new Nude),"undefined"!=typeof this.trinket?(this.wear(this.trinket),this.addToInv(this.trinket)):this.wear(new Nothing),this.addToInv(currentGame.itemFromString(randomEntry(this.common))),2===roll("1d2")&&this.addToInv(currentGame.itemFromString(randomEntry(this.uncommon))),3===roll("1d3")&&this.addToInv(currentGame.itemFromString(randomEntry(this.rare))),this.effectController=new Effect,this.effectController.link(this),this.draw(this.canvas,this.spriteCompressed),this.stats.HP=this.stats.maxHP,this.gold=roll(this.purseStr),this.updateStatus()},Monster.prototype.mimic=function(){this.offHand="",this.div.classList.remove("inanimate"),currentGame.log.add(firstCap(this.selfStr())+" comes to life!"),this.shortName=this.revealedName,this.displayElement.name.innerHTML=this.shortName,this.aiType="simple",this.updateStatus(),setTimeout(function(){intervalRelay="Check equip"},1e3)},Monster.prototype.loot=function(){var t=currentGame.playerHero.unlucky>=4?!0:roll("1d20")<=this.lootChance;t=currentGame.currentLocation.switchTrigger<=0?!1:t;var e="You found ",s=this.inventory.length>0?randomEntry(this.inventory):!1,i=this;e+=t&&s?"a "+s.shortName+"!":this.gold+" gold!",setTimeout(function(){currentGame.log.add(e),t&&s?(currentGame.playerHero.unlucky=0,currentGame.playerHero.receive(s,!0)):(currentGame.playerHero.unlucky++,currentGame.playerHero.gold+=i.gold,setTimeout(currentGame.switchMonster,2e3))},1e3)},Axedude.prototype=new Monster,Axedude.prototype.constructor=Axedude,Ball.prototype=new Monster,Ball.prototype.constructor=Ball,Chest.prototype=new Monster,Chest.prototype.constructor=Chest,Jelly.prototype=new Monster,Jelly.prototype.constructor=Jelly,Scamp.prototype=new Monster,Scamp.prototype.constructor=Scamp,Skele.prototype=new Monster,Skele.prototype.constructor=Skele,Snek.prototype=new Monster,Snek.prototype.constructor=Snek,Were.prototype=new Monster,Were.prototype.constructor=Were,Mage.prototype=new Monster,Mage.prototype.constructor=Mage,Item.prototype=new Displayable,Item.prototype.constructor=Item,Item.prototype.checkExhausted=function(){return this.uses<=0},Item.prototype.exhaust=function(){if(this.uses!==!0){this.destroy();var t=firstCap(this.owner.possesive())+" "+this.shortName.toLowerCase()+" "+this.breakVerb+" and is discarded.";currentGame.log.add(t)}},Item.prototype.destroy=function(){switch(this){case this.owner.armor:this.owner.switchArmor();break;case this.owner.accessory:this.owner.switchAccessory();break;case this.owner.hand1:this.owner.equip1(new Punch);
break;case this.owner.hand2:this.owner.equip2(new Punch)}var t=this.owner.inventory.indexOf(this);t>=0&&this.owner.inventory.splice(t,1),this.owner.updateStatus()},Item.prototype.target=function(){return this.selfTargeted?this.owner:this.owner.getEnemy()},Item.prototype.attackObj=function(){var t={};return t.targetCharacter=this.target(),t.natural=this.natural,t.calculated=this.attackVal(),t.type=this.attackType,t.sprite=this.sprite,t.color=this.color,t.noDamage=this.noDamage,t.uniqueStr=this.uniqueStr,t.unique=this.unique,"Punch"===this.constructor.name&&"Hero"!==this.owner.constructor.name&&(t.color=this.owner.color),t.verbs=this.verbs,t.itemType=this.itemType,t.selfTargeted=this.selfTargeted,t.buffArr=this.buffArr,t.killStr=this.killStr,"Buff"===this.itemType&&(t.cureChance=this.cureChance),this.owner.buffs.includes("Aflame")&&"Weapon"===this.itemType&&(t.buffArr=["Aflame",3]),t.targetStat=this.targetStat,t},Item.prototype.statsStr=function(){if(0===Object.keys(this.stats).length)return"";var t=1,e="";for(var s in this.stats){var i=this.stats[s]>0?"+":"-",a=t>=Object.keys(this.stats).length?"":", ";e+=s.toUpperCase()+": "+i+this.stats[s]+a,t++}return e+="<br>"},Item.prototype.resistsStr=function(){if(0===Object.keys(this.resists).length)return"";var t="",e=1;for(var s in this.resists)signfier=this.resists[s]>0?"":"-",joiner=e>=Object.keys(this.resists).length?"":", ",t+=s.toUpperCase()+": "+signfier+100*this.resists[s]+"%"+joiner,e++;return t+="<br>"},Item.prototype.immunitiesStr=function(){if(0===this.immunities.length)return"";for(var t="Adds Immunity to: ",e=this.immunities.length-1;e>=0;e--)joiner=1!==e?"":", ",t+=this.immunities[e]+joiner;return t+="<br>"},Item.prototype.buffsStr=function(){if(0===this.buffs.length)return"";for(var t="Equipping adds: ",e=this.buffs.length-1;e>=0;e--)joiner=1!==e?"":", ",t+=this.buffs[e]+joiner;return t+="<br>"},Item.prototype.equippedStr=function(){var t=[this.owner.armor,this.owner.accessory,this.owner.hand1,this.owner.hand2];if(!t.includes(this)||"undefined"==typeof this.itemType)return"";var e="";switch(this){case this.owner.hand1:case this.owner.hand2:var s=this.owner.hand1===this?"right":"left";e="At the ready in your "+s+" hand.";break;case this.owner.armor:case this.owner.accessory:e="You are wearing this."}return e+="<br>"},Item.prototype.invDialog=function(){if(currentGame.foundItem="","Hero"===this.owner.constructor.name){var t=this.shortName+":<br>"+firstCap(this.displayName)+".<br><br>",e=this.equippedStr()+this.infoStr();""!==e&&(t+=e+"<br>");var s=this.statsStr()+this.resistsStr()+this.immunitiesStr()+this.buffsStr();if(""!==s&&(t+=s+"<br>"),t+="Uses left: "+this.uses,this.owner.hand1===this||this.owner.hand2===this){var i,a;this.owner.hand1===this?(i="right",a=1):(i="right",a=2),currentGame.dialog.addButton("Use this from your "+i+" hand","runRound activate"+a,"suggest"),currentGame.dialog.addButton("Un-equip this item","router unEquip"+i,"caution")}else switch(this.itemType){case"Accessory":if(this.owner.accessory===this)currentGame.dialog.addButton("Remove "+this.shortName,"runRound removeOffhand","caution");else{var r="Nothing"!==this.owner.accessory.constructor.name?"instead of "+this.owner.accessory.shortName:"the "+this.shortName;currentGame.dialog.addButton("Wear "+r,"runRound wearOffhand","caution")}break;case"Armor":if(this.owner.armor===this)currentGame.dialog.addButton("Remove "+this.shortName,"runRound removeOffhand","caution");else{var o="Nude"!==this.owner.armor.constructor.name?"instead of "+this.owner.armor.shortName:"the "+this.shortName;currentGame.dialog.addButton("Wear "+o,"runRound wearOffhand","caution")}break;case"Consumable":currentGame.dialog.addButton("Use without equipping","runRound activateOffhand","caution");case"Weapon":var n="Punch"!==this.owner.hand2.constructor.name?"instead of "+this.owner.hand2.shortName:"in your left hand",h="Punch"!==this.owner.hand1.constructor.name?"instead of "+this.owner.hand1.shortName:"in your right hand";currentGame.dialog.addButton("Equip "+h,"runRound equip1Offhand"),currentGame.dialog.addButton("Equip "+n,"runRound equip2Offhand")}this.owner.offHand=this;var c=this.owner.inventory.indexOf(this);currentGame.dialog.setText(t),currentGame.dialog.addButton("Drop the "+this.shortName,"dropItem "+c,"warning"),currentGame.dialog.addButton("Cancel","router closeDialog"),currentGame.dialog.open()}},Buff.prototype=new Item,Buff.prototype.constructor=Buff,Weapon.prototype=new Item,Weapon.prototype.constructor=Weapon,Weapon.prototype.infoStr=function(){if(this.unique===!0)return"";var t="Attacks enemy's "+this.targetStat;t+=" with "+this.attackType+" damage, using ";var e="your "+this.userTraits.join(" and ")+".";if(t+=this.userTraits.length>0?e:"complete chance.",this.buffArr.length>1){var s=this.buffArr[1]>1?" 1 in "+this.buffArr[1]+" chance to cause":" Causes";t+=s+" enemy to be "+this.buffArr[0].toLowerCase()+"."}return t+="<br>"},Punch.prototype=new Weapon,Punch.prototype.constructor=Punch,Sword.prototype=new Weapon,Sword.prototype.constructor=Sword,Buckler.prototype=new Weapon,Buckler.prototype.constructor=Buckler,Axe.prototype=new Weapon,Axe.prototype.constructor=Axe,Bow.prototype=new Weapon,Bow.prototype.constructor=Bow,Staff.prototype=new Weapon,Staff.prototype.constructor=Staff,Claws.prototype=new Weapon,Claws.prototype.constructor=Claws,Hose.prototype=new Weapon,Hose.prototype.constructor=Hose,Consumable.prototype=new Item,Consumable.prototype.constructor=Consumable,Consumable.prototype.infoStr=function(){if(this.unique===!0)return"";var t=this.hurts?"Damages":"Heals",e=t+" you for "+this.amountDmg+" "+this.targetStat.toUpperCase()+".";if(this.buffArr.length>1){var s=this.buffArr[1]>1?" 1 in "+this.buffArr[1]+" chance to cause":" Causes";e+=s+" you to be "+this.buffArr[0].toLowerCase()+"."}return e+="<br>"},Bomb.prototype=new Consumable,Bomb.prototype.constructor=Bomb,Potion.prototype=new Consumable,Potion.prototype.constructor=Potion,Vial.prototype=new Consumable,Vial.prototype.constructor=Vial,Food.prototype=new Consumable,Food.prototype.constructor=Food,Wearable.prototype=new Item,Wearable.prototype.constructor=Wearable,Wearable.prototype.infoStr=function(){return""},Armor.prototype=new Wearable,Armor.prototype.constructor=Armor,Nude.prototype=new Armor,Nude.prototype.constructor=Nude,Cloth.prototype=new Armor,Cloth.prototype.constructor=Cloth,Plate.prototype=new Armor,Plate.prototype.constructor=Plate,Accessory.prototype=new Wearable,Accessory.prototype.constructor=Accessory,Nothing.prototype=new Accessory,Nothing.prototype.constructor=Nothing,Ring.prototype=new Accessory,Ring.prototype.constructor=Ring,Effect.prototype=new Displayable,Effect.prototype.constructor=Effect,Effect.prototype.link=function(t){this.associatedCharacter=t,this.damageElement=t.div.getElementsByClassName("damage-sprite")[0],this.damageCanvas=this.damageElement.getContext("2d")},Effect.prototype.displayDamage=function(t,e){this.color=e,this.damageElement.classList.add("active",t),this.draw(this.damageCanvas,this.sprites[t]);var s=this;setTimeout(function(){s.clear()},500)},Effect.prototype.clear=function(){this.damageElement.className="damage-sprite"},loadButtons(document),currentGame.initialize();